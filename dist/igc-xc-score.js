var IGCScore;(()=>{var t={347:(t,e,r)=>{"use strict";r(126);var n=r(647),i=r(161);function o(t,e){if(!(this instanceof o))return new o(t,e);e=e||Function.noop,this.getDefault=e,this.store=Object.create(null),this.length=0,this.addEach(t)}t.exports=o,o.Dict=o,Object.addEach(o.prototype,n.prototype),Object.addEach(o.prototype,i.prototype),o.from=n.from,o.prototype.constructClone=function(t){return new this.constructor(t,this.getDefault)},o.prototype.assertString=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t)},Object.defineProperty(o.prototype,"$__proto__",{writable:!0}),Object.defineProperty(o.prototype,"_hasProto",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this._protoValue}}),Object.defineProperty(o.prototype,"_protoValue",{get:function(){return this.$__proto__},set:function(t){this.$__proto__=t}}),Object.defineProperty(o.prototype,"size",n._sizePropertyDescriptor),o.prototype.get=function(t,e){return this.assertString(t),"__proto__"===t?this._hasProto?this._protoValue:arguments.length>1?e:this.getDefault(t):t in this.store?this.store[t]:arguments.length>1?e:this.getDefault(t)},o.prototype.set=function(t,e){this.assertString(t);var r="__proto__"===t;return(r?this._hasProto:t in this.store)?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,r?this._protoValue:this.store[t]),r?this._protoValue=e:this.store[t]=e,this.dispatchesMapChanges&&this.dispatchMapChange(t,e),!1):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,void 0),this.length++,r?this._protoValue=e:this.store[t]=e,this.dispatchesMapChanges&&this.dispatchMapChange(t,e),!0)},o.prototype.has=function(t){return this.assertString(t),"__proto__"===t?this._hasProto:t in this.store},o.prototype.delete=function(t){return this.assertString(t),"__proto__"===t?!!this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,this._protoValue),this._protoValue=void 0,this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(t,void 0),!0):t in this.store&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,this.store[t]),delete this.store[t],this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(t,void 0),!0)},o.prototype.clear=function(){var t;for(t in this._hasProto&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange("__proto__",this._protoValue),this._protoValue=void 0,this.dispatchesMapChanges&&this.dispatchMapChange("__proto__",void 0)),this.store)this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,this.store[t]),delete this.store[t],this.dispatchesMapChanges&&this.dispatchMapChange(t,void 0);this.length=0},o.prototype.reduce=function(t,e,r){this._hasProto&&(e=t.call(r,e,"$__proto__","__proto__",this));var n=this.store;for(var i in this.store)e=t.call(r,e,n[i],i,this);return e},o.prototype.reduceRight=function(t,e,r){var n=this,i=this.store;return e=Object.keys(this.store).reduceRight((function(e,o){return t.call(r,e,i[o],o,n)}),e),this._hasProto?t.call(r,e,this._protoValue,"__proto__",n):e},o.prototype.one=function(){var t;for(t in this.store)return this.store[t];return this._protoValue},o.prototype.toJSON=function(){return this.toObject()}},600:(t,e,r)=>{"use strict";r(126);var n=r(347),i=r(55),o=r(647),s=r(900),a=r(312);function h(t,e,r,n){if(!(this instanceof h))return new h(t,e,r,n);e=e||Object.equals,r=r||Object.hash,n=n||Function.noop,this.contentEquals=e,this.contentHash=r,this.getDefault=n;var i=this;this.buckets=new this.Buckets(null,(function(){return new i.Bucket})),this.length=0,this.addEach(t)}Object.prototype.hasOwnProperty,t.exports=h,h.FastSet=h,Object.addEach(h.prototype,o.prototype),Object.addEach(h.prototype,s.prototype),h.from=o.from,h.prototype.Buckets=n,h.prototype.Bucket=i,h.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentHash,this.getDefault)},h.prototype.has=function(t){var e=this.contentHash(t);return this.buckets.get(e).has(t)},h.prototype.get=function(t,e){if(e)throw new Error("FastSet#get does not support second argument: equals");var r=this.contentHash(t),n=this.buckets;return n.has(r)?n.get(r).get(t):this.getDefault(t)},h.prototype.delete=function(t,e){if(e)throw new Error("FastSet#delete does not support second argument: equals");var r=this.contentHash(t),n=this.buckets;if(n.has(r)){var i=n.get(r);if(i.delete(t))return this.length--,0===i.length&&n.delete(r),!0}return!1},h.prototype.clear=function(){this.buckets.clear(),this.length=0},h.prototype.add=function(t){var e=this.contentHash(t),r=this.buckets;return r.has(e)||r.set(e,new this.Bucket(null,this.contentEquals)),!r.get(e).has(t)&&(r.get(e).add(t),this.length++,!0)},h.prototype.reduce=function(t,e){var r=arguments[2],n=this.buckets,i=0;return n.reduce((function(e,n){return n.reduce((function(e,n){return t.call(r,e,n,i++,this)}),e,this)}),e,this)},h.prototype.one=function(){if(this.length>0)return this.buckets.one().one()},h.prototype.iterate=function(){return this.buckets.valuesArray().flatten().iterate()},h.prototype.log=function(t,e,r,n){t=t||a.unicodeSharp,e=e||this.logNode,r||(r=console.log,n=console),r=r.bind(n);for(var i,o,s,h,c=this.buckets,u=c.size,l=c.keys(),p=0;i=l.next().value;)p===u-1?(o=t.fromAbove,s=" "):0===p?(o=t.branchDown,s=t.strafe):(o=t.fromBoth,s=t.strafe),h=c.get(i),r.call(n,o+t.through+t.branchDown+" "+i),h.forEach((function(i,o){var a,c,u;o===h.head.prev?(a=t.fromAbove,c=" "):(a=t.fromBoth,c=t.strafe),e(o,(function(e){u?r.call(n,s+" "+c+"  "+e):(r.call(n,s+" "+a+t.through+t.through+e),u=!0)}),(function(e){r.call(n,s+" "+t.strafe+"  "+e)}))})),p++},h.prototype.logNode=function(t,e){var r=t.value;Object(r)===r?JSON.stringify(r,null,4).split("\n").forEach((function(t){e(" "+t)})):e(" "+r)}},55:(t,e,r)=>{"use strict";t.exports=o,r(126);var n=r(647),i=r(188);function o(t,e,r){return o._init(o,this,t,e,r)}function s(t){this.head=t,this.at=t.next}function a(t){this.value=t,this.prev=null,this.next=null}o._init=function(t,e,r,n,i){if(!(e instanceof t))return new t(r,n,i);var o=e.head=new e.Node;o.next=o,o.prev=o,e.contentEquals=n||Object.equals,e.getDefault=i||Function.noop,e.length=0,e.addEach(r)},o.List=o,Object.addEach(o.prototype,n.prototype),Object.addEach(o.prototype,i.prototype),o.from=n.from,o.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.getDefault)},o.prototype.find=function(t,e,r){e=e||this.contentEquals;for(var n=this.head,i=this.scan(r,n.next);i!==n;){if(e(i.value,t))return i;i=i.next}},o.prototype.findLast=function(t,e,r){e=e||this.contentEquals;for(var n=this.head,i=this.scan(r,n.prev);i!==n;){if(e(i.value,t))return i;i=i.prev}},o.prototype.has=function(t,e){return!!this.find(t,e)},o.prototype.get=function(t,e){var r=this.find(t,e);return r?r.value:this.getDefault(t)},o.prototype.delete=function(t,e){var r=this.findLast(t,e);return!!r&&(r.delete(),this.length--,!0)},o.prototype.deleteAll=function(t,e){e=e||this.contentEquals;for(var r=this.head,n=r.next,i=0;n!==r;)e(t,n.value)&&(n.delete(),i++),n=n.next;return this.length-=i,i},o.prototype.clear=function(){this.head.next=this.head.prev=this.head,this.length=0},o.prototype.add=function(t){var e=new this.Node(t);return this._addNode(e)},o.prototype._addNode=function(t){return this.head.addBefore(t),this.length++,!0},o.prototype.push=function(){for(var t=this.head,e=0;e<arguments.length;e++){var r=arguments[e],n=new this.Node(r);t.addBefore(n)}this.length+=arguments.length},o.prototype.unshift=function(){for(var t=this.head,e=0;e<arguments.length;e++){var r=arguments[e],n=new this.Node(r);t.addAfter(n),t=n}this.length+=arguments.length},o.prototype._shouldPop=function(){var t,e=this.head;return e.prev!==e&&(t=e.prev.value),t},o.prototype.pop=function(t,e){var r,n=this.head;if(n.prev!==n){r=n.prev.value;var i=this.length-1,o=t?t.call(this,r,i):void 0;n.prev.delete(),this.length--,e&&e.call(this,r,i,o)}return r},o.prototype.shift=function(t,e){var r,n=this.head;if(n.prev!==n){r=n.next.value;var i=t?t.call(this,r,0):void 0;n.next.delete(),this.length--,e&&e.call(this,r,0,i)}return r},o.prototype.peek=function(){if(this.head!==this.head.next)return this.head.next.value},o.prototype.poke=function(t){this.head!==this.head.next?this.head.next.value=t:this.push(t)},o.prototype.one=function(){return this.peek()},o.prototype.scan=function(t,e){var r=this.head;if("number"==typeof t){var n=t;if(n>=0)for(t=r.next;n&&(n--,(t=t.next)!=r););else for(t=r;n<0&&(n++,(t=t.prev)!=r););return t}return t||e},o.prototype.slice=function(t,e){var r=[],n=this.head;for(t=this.scan(t,n.next),e=this.scan(e,n);t!==e&&t!==n;)r.push(t.value),t=t.next;return r},o.prototype.splice=function(t,e){return this.swap(t,e,Array.prototype.slice.call(arguments,2))},o.prototype.swap=function(t,e,r,n,i){var o=t;t=this.scan(t,this.head),null==e&&(e=1/0),r=Array.from(r);for(var s=[],a=t;e--&&e>=0&&a!==this.head;)s.push(a.value),a=a.next;n&&n.call(this,t,r,s),a=t;var h=0;for(a=t;h<s.length;h++,a=a.next)a.delete();for(null==o&&a===this.head&&(a=this.head.next),h=0;h<r.length;h++){var c=new this.Node(r[h]);a.addBefore(c)}return this.length+=r.length-s.length,i&&i.call(this,t,r,s),s},o.prototype.reverse=function(){var t=this.head;do{var e=t.next;t.next=t.prev,t.prev=e,t=t.next}while(t!==this.head);return this},o.prototype.sort=function(){this.swap(0,this.length,this.sorted.apply(this,arguments))},o.prototype.reduce=function(t,e){for(var r=arguments[2],n=this.head,i=n.next;i!==n;)e=t.call(r,e,i.value,i,this),i=i.next;return e},o.prototype.reduceRight=function(t,e){for(var r=arguments[2],n=this.head,i=n.prev;i!==n;)e=t.call(r,e,i.value,i,this),i=i.prev;return e},o.prototype.updateIndexes=function(t,e){for(;t!==this.head;)t.index=e++,t=t.next},o.prototype.iterate=function(){return new s(this.head)},s.prototype.__iterationObject=null,Object.defineProperty(s.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),s.prototype.next=function(){if(this.at===this.head)this._iterationObject.done=!0,this._iterationObject.value=void 0;else{var t=this.at.value;this.at=this.at.next,this._iterationObject.value=t}return this._iterationObject},o.prototype.Node=a,a.prototype.delete=function(){this.prev.next=this.next,this.next.prev=this.prev},a.prototype.addBefore=function(t){var e=this.prev;this.prev=t,t.prev=e,e.next=t,t.next=this},a.prototype.addAfter=function(t){var e=this.next;this.next=t,t.next=e,e.prev=t,t.prev=this}},556:(t,e,r)=>{"use strict";r(126);var n,i,o,s=r(647);if(void 0!==r.g.Map&&"function"==typeof r.g.Set.prototype.values){var a;i=n=t.exports=r.g.Map,n.Map=n,a={}.__proto__===Object.prototype?function(){this.__proto__=g}:function(){Object.defineProperties(this,observableSetProperties)},Object.defineProperty(n.prototype,"makeObservable",{value:a,writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(n.prototype,"makePropertyObservable",{value:function(){},writable:!0,configurable:!0,enumerable:!1}),n.prototype.constructClone=function(t){return new this.constructor(t)},n.prototype.isMap=!0,n.prototype.addEach=function(t){if(t&&Object(t)===t)if("function"==typeof t.forEach)!0===t.isMap?t.forEach((function(t,e){this.set(e,t)}),this):t.forEach((function(t){this.set(t[0],t[1])}),this);else if("number"==typeof t.length)for(var e=0;e<t.length;e++)this.add(t[e],e);else Object.keys(t).forEach((function(e){this.set(e,t[e])}),this);else if(t&&"number"==typeof t.length)for(e=0;e<t.length;e++)this.add(t[e],e);return this},n.prototype.add=function(t,e){return this.set(e,t)},n.prototype.reduce=function(t,e){var r=arguments[2];return this.forEach((function(n,i,o){e=t.call(r,e,n,i,this)})),e},n.prototype.reduceRight=function(t,e){for(var r,n=arguments[2],i=this.keys(),o=this.size,s=new Array(this.size),a=0;r=i.next().value;)s[--o]=r;for(;a++<o;)e=t.call(n,e,this.get(s[a]),s[a],this);return e},n.prototype.equals=function(t,e){return e=e||Object.equals,this===t||(t&&"function"==typeof t.every?t.size===this.size&&t.every((function(t,r){return e(this.get(r),t)}),this):Object.keys(t).length===this.size&&Object.keys(t).every((function(r){return e(this.get(r),t[r])}),this))};var h=function(t,e){return e};n.prototype.keysArray=function(){return this.map(h)};var c=function(t,e){return t};n.prototype.valuesArray=function(){return this.map(c)};var u=function(t,e){return[e,t]};n.prototype.entriesArray=function(){return this.map(u)},n.prototype.toJSON=function(){return this.entriesArray()},n.prototype.items=function(){return this.entriesArray()},n.from=function(t){var e=new this;return e.addEach(t),e},Object.defineProperty(n.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0});var l=n.prototype.clear,p=n.prototype.set,f=n.prototype.delete,d={clear:{value:function(){var t;this.dispatchesMapChanges&&(this.forEach((function(t,e){this.dispatchBeforeMapChange(e,t)}),this),t=this.keysArray()),l.call(this),this.dispatchesMapChanges&&t.forEach((function(t){this.dispatchMapChange(t)}),this)},writable:!0,configurable:!0},set:{value:function(t,e){var r=this.get(t);return r?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,r),p.call(this,t,e),this.dispatchesMapChanges&&this.dispatchMapChange(t,e)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,void 0),p.call(this,t,e),this.dispatchesMapChanges&&this.dispatchMapChange(t,e)),this},writable:!0,configurable:!0},delete:{value:function(t){return!!this.has(t)&&(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,this.get(t)),f.call(this,t),this.dispatchesMapChanges&&this.dispatchMapChange(t,void 0),!0)}}};Object.addEach(n.prototype,s.prototype,!1);var g=Object.create(n.prototype,d)}var y=r(781).CollectionsSet,v=r(161);o=n=function t(e,r,n,i){if(!(this instanceof t))return new t(e,r,n,i);r=r||Object.equals,n=n||Object.hash,i=i||Function.noop,this.contentEquals=r,this.contentHash=n,this.getDefault=i,this.store=new y(void 0,(function(t,e){return r(t.key,e.key)}),(function(t){return n(t.key)})),this.length=0,this.addEach(e)},n.Map=n,Object.addEach(n.prototype,s.prototype),Object.addEach(n.prototype,v.prototype),Object.defineProperty(n.prototype,"size",s._sizePropertyDescriptor),n.from=s.from,n.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentHash,this.getDefault)},n.prototype.log=function(t,e,r,n){e=e||this.logNode,this.store.log(t,(function(t,r,n){e(t.value.value,r,n)}),r,n)},n.prototype.logNode=function(t,e){e(" key: "+t.key),e(" value: "+t.value)},i?(t.exports=i,i.CollectionsMap=o):t.exports=o},781:(t,e,r)=>{"use strict";r(126);var n,i,o=r(647),s=r(900);void 0!==r.g.Set&&"function"==typeof r.g.Set.prototype.values&&((n=t.exports=r.g.Set).Set=n,n.prototype.reduce=function(t,e){var r=arguments[2];return this.forEach((function(n){e=t.call(r,e,n,this)})),e},n.prototype.reduceRight=function(t,e){for(var r,n=arguments[2],i=this.values(),o=this.size,s=new Array(this.size),a=o;r=i.next().value;)s[--a]=r;for(;a<o;)e=t.call(n,e,s[a++],this);return e},n.prototype.equals=function(t,e){var r=this;return t&&"function"==typeof t.reduce&&this.size===(t.size||t.length)&&t.reduce((function(t,n){return t&&r.has(n,e)}),!0)},n.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentHash,this.getDefault)},n.prototype.toJSON=function(){return this.entriesArray()},n.prototype.one=function(){if(this.size>0)return this.values().next().value},n.prototype.pop=function(){if(this.size){for(var t,e,r=this.values();t=r.next().value;)e=t;return this.delete(e,this.size-1),e}},n.prototype.shift=function(){if(this.size){var t=this.values().next().value;return this.delete(t,0),t}},Object.defineProperty(n.prototype,"length",{get:function(){return this.size},enumerable:!0,configurable:!0}),n.from=function(t){var e=new this;return e.addEach(t),e},Object.addEach(n.prototype,o.prototype,!1),Object.addEach(n.prototype,s.prototype,!1));var a=r(55),h=r(600),c=r(582);(i=function t(e,r,n,i){return t._init(t,this,e,r,n,i)})._init=function(t,e,r,n,i,o){if(!(e instanceof t))return new t(r,n,i,o);n=n||Object.equals,i=i||Object.hash,o=o||Function.noop,e.contentEquals=n,e.contentHash=i,e.getDefault=o,e.order=new e.Order(void 0,n),e.store=new e.Store(void 0,(function(t,e){return n(t.value,e.value)}),(function(t){return i(t.value)})),e.length=0,e.addEach(r)},i.Set=i,i.CollectionsSet=i,Object.addEach(i.prototype,o.prototype),Object.addEach(i.prototype,s.prototype),i.from=o.from,Object.defineProperty(i.prototype,"size",o._sizePropertyDescriptor),i.prototype.Order=a,i.prototype.Store=h,i.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentHash,this.getDefault)},i.prototype.has=function(t){var e=new this.order.Node(t);return this.store.has(e)},i.prototype.get=function(t,e){if(e)throw new Error("Set#get does not support second argument: equals");var r=new this.order.Node(t);return(r=this.store.get(r))?r.value:this.getDefault(t)},i.prototype.add=function(t){var e=new this.order.Node(t);return!this.store.has(e)&&(this.length,this.order.add(t),e=this.order.head.prev,this.store.add(e),this.length++,!0)},i.prototype.delete=function(t,e){if(e)throw new Error("Set#delete does not support second argument: equals");var r=new this.order.Node(t);return!!this.store.has(r)&&(r=this.store.get(r),this.store.delete(r),this.order.splice(r,1),this.length--,!0)},i.prototype.pop=function(){if(this.length){var t=this.order.head.prev.value;return this.delete(t),t}},i.prototype.shift=function(){if(this.length){var t=this.order.head.next.value;return this.delete(t),t}},i.prototype.one=function(){if(this.length>0)return this.store.one().value},i.prototype.clear=function(){this.store.clear(),this.order.clear(),this.length=0},Object.defineProperty(i.prototype,"_clear",{value:i.prototype.clear}),i.prototype.reduce=function(t,e){var r=arguments[2],n=this.order,i=0;return n.reduce((function(e,n){return t.call(r,e,n,i++,this)}),e,this)},i.prototype.reduceRight=function(t,e){var r=arguments[2],n=this.order,i=this.length-1;return n.reduceRight((function(e,n){return t.call(r,e,n,i--,this)}),e,this)},i.prototype.iterate=function(){return this.order.iterate()},i.prototype.values=function(){return new c(this.valuesArray(),!0)},i.prototype.log=function(){var t=this.store;return t.log.apply(t,arguments)},n?(n.prototype.valuesArray=s.prototype.valuesArray,n.prototype.entriesArray=s.prototype.entriesArray,t.exports=n,n.CollectionsSet=i):t.exports=i},647:(t,e,r)=>{"use strict";function n(){throw new Error("Can't construct. GenericCollection is a mixin.")}t.exports=n;var i=r.g.DOMTokenList||function(){};n.EmptyArray=Object.freeze([]),n.prototype.addEach=function(t,e,r){if(t&&(t instanceof Array||t instanceof i||t instanceof String))if(e)for(var n=0;n<t.length;n++)this.add(e.call(r,t[n]),n);else for(n=0;n<t.length;n++)this.add(t[n],n);else if(t&&Object(t)===t)if("function"==typeof t.forEach)e?t.map(e,r).forEach(this.add,this):t.forEach(this.add,this);else if("function"==typeof t.next){var o;if(n=0,e)for(;o=t.next().value;)this.add(e.call(r,o),n++);else for(;o=t.next().value;)this.add(o,n++)}else if("number"==typeof t.length)if(e)for(n=0;n<t.length;n++)this.add(e.call(r,t[n]),n);else for(n=0;n<t.length;n++)this.add(t[n],n);else e?Object.keys(t).forEach((function(n){this.add(e.call(r,t[n]),n)}),this):Object.keys(t).forEach((function(e){this.add(t[e],e)}),this);return this},n.prototype.deleteEach=function(t,e){return t.forEach((function(t){this.delete(t,e)}),this),this},n.prototype.forEach=function(t){var e=arguments[1];return this.reduce((function(r,n,i,o,s){t.call(e,n,i,o,s)}),void 0)},n.prototype.map=function(t){var e=arguments[1],r=[];return this.reduce((function(n,i,o,s,a){r.push(t.call(e,i,o,s,a))}),void 0),r},n.prototype.enumerate=function(t){null==t&&(t=0);var e=[];return this.reduce((function(r,n){e.push([t++,n])}),void 0),e},n.prototype.group=function(t,e,r){r=r||Object.equals;var n=[],i=[];return this.forEach((function(o,s,a){s=t.call(e,o,s,a);var h,c=i.indexOf(s,r);-1===c?(h=[],n.push([s,h]),i.push(s)):h=n[c][1],h.push(o)})),n},n.prototype.toArray=function(){return this.map(Function.identity)},n.prototype.toObject=function(){var t={};return this.reduce((function(e,r,n){t[n]=r}),void 0),t},n.from=function(){return this.apply(this,arguments)},n.prototype.filter=function(t){var e=arguments[1],r=this.constructClone();return this.reduce((function(n,i,o,s,a){t.call(e,i,o,s,a)&&r.add(i,o)}),void 0),r},n.prototype.every=function(t){var e=arguments[1];return this.reduce((function(r,n,i,o,s){return r&&t.call(e,n,i,o,s)}),!0)},n.prototype.some=function(t){var e=arguments[1];return this.reduce((function(r,n,i,o,s){return r||t.call(e,n,i,o,s)}),!1)},n.prototype.all=function(){return this.every(Boolean)},n.prototype.any=function(){return this.some(Boolean)},n.prototype.min=function(t){t=t||this.contentCompare||Object.compare;var e=!0;return this.reduce((function(r,n){return e?(e=!1,n):t(n,r)<0?n:r}),void 0)},n.prototype.max=function(t){t=t||this.contentCompare||Object.compare;var e=!0;return this.reduce((function(r,n){return e?(e=!1,n):t(n,r)>0?n:r}),void 0)},n.prototype.sum=function(t){return t=void 0===t?0:t,this.reduce((function(t,e){return t+e}),t)},n.prototype.average=function(t){var e=void 0===t?0:t,r=void 0===t?0:t;return this.reduce((function(t,n){e+=n,r+=1}),void 0),e/r},n.prototype.concat=function(){for(var t=this.constructClone(this),e=0;e<arguments.length;e++)t.addEach(arguments[e]);return t},n.prototype.flatten=function(){var t=this;return this.reduce((function(e,r){return r.forEach((function(t){this.push(t)}),e,t),e}),[])},n.prototype.zip=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),Array.unzip(t)},n.prototype.join=function(t){return this.reduce((function(e,r){return void 0===e?r:e+t+r}),void 0)},n.prototype.sorted=function(t,e,r){return(t=t||this.contentCompare||Object.compare).by?(e=t.by,t=t.compare||this.contentCompare||Object.compare):e=e||Function.identity,void 0===r&&(r=1),this.map((function(t){return{by:e(t),value:t}})).sort((function(e,n){return t(e.by,n.by)*r})).map((function(t){return t.value}))},n.prototype.reversed=function(){return this.constructClone(this).reverse()},n.prototype.clone=function(t,e){if(void 0===t)t=1/0;else if(0===t)return this;var r=this.constructClone();return this.forEach((function(n,i){r.add(Object.clone(n,t-1,e),i)}),this),r},n.prototype.only=function(){if(1===this.length)return this.one()},n.prototype.iterator=function(){return this.iterate.apply(this,arguments)},n._sizePropertyDescriptor={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(n.prototype,"size",n._sizePropertyDescriptor),r(943)},161:(t,e,r)=>{"use strict";var n=r(930),i=r(582);function o(){throw new Error("Can't construct. GenericMap is a mixin.")}function s(t,e){this.key=t,this.value=e}t.exports=o,o.prototype.isMap=!0,o.prototype.addEach=function(t){var e;if(t&&n(t)===t)if("function"==typeof t.forEach)!0===t.isMap?t.forEach((function(t,e){this.set(e,t)}),this):t.forEach((function(t){this.set(t[0],t[1])}),this);else if("number"==typeof t.length)for(e=0;e<t.length;e++)this.add(t[e],e);else n.keys(t).forEach((function(e){this.set(e,t[e])}),this);else if(t&&"number"==typeof t.length)for(e=0;e<t.length;e++)this.add(t[e],e);return this},o.prototype.get=function(t,e){var r=this.store.get(new this.Item(t));return r?r.value:arguments.length>1?(console.log("Use of a second argument as default value is deprecated to match standards"),e):this.getDefault(t)},o.prototype.set=function(t,e){var r=new this.Item(t,e),n=this.store.get(r);return n?(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,n.value),n.value=e,this.dispatchesMapChanges&&this.dispatchMapChange(t,e)):(this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,void 0),this.store.add(r)&&this.length++,this.dispatchesMapChanges&&this.dispatchMapChange(t,e)),this},o.prototype.add=function(t,e){return this.set(e,t)},o.prototype.has=function(t){return this.store.has(new this.Item(t))},o.prototype.delete=function(t){var e=new this.Item(t);if(this.store.has(e)){var r=this.store.get(e).value;return this.dispatchesMapChanges&&this.dispatchBeforeMapChange(t,r),this.store.delete(e),this.length--,this.dispatchesMapChanges&&this.dispatchMapChange(t,void 0),!0}return!1},o.prototype.clear=function(){var t,e;if(this.dispatchesMapChanges&&(this.forEach((function(t,e){this.dispatchBeforeMapChange(e,t)}),this),t=this.keysArray()),this.store.clear(),this.length=0,this.dispatchesMapChanges)for(var r=0;e=t[r];r++)this.dispatchMapChange(e)},o.prototype.reduce=function(t,e,r){return this.store.reduce((function(e,n){return t.call(r,e,n.value,n.key,this)}),e,this)},o.prototype.reduceRight=function(t,e,r){return this.store.reduceRight((function(e,n){return t.call(r,e,n.value,n.key,this)}),e,this)},o.prototype.keysArray=function(){return this.map((function(t,e){return e}))},o.prototype.keys=function(){return new i(this.keysArray(),!0)},o.prototype.valuesArray=function(){return this.map(Function.identity)},o.prototype.values=function(){return new i(this.valuesArray(),!0)},o.prototype.entriesArray=function(){return this.map((function(t,e){return[e,t]}))},o.prototype.entries=function(){return new i(this.entriesArray(),!0)},o.prototype.items=function(){return this.entriesArray()},o.prototype.equals=function(t,e){return e=e||n.equals,this===t||(t&&"function"==typeof t.every?t.length===this.length&&t.every((function(t,r){return e(this.get(r),t)}),this):n.keys(t).length===this.length&&n.keys(t).every((function(r){return e(this.get(r),t[r])}),this))},o.prototype.toJSON=function(){return this.entriesArray()},o.prototype.Item=s,s.prototype.equals=function(t){return n.equals(this.key,t.key)&&n.equals(this.value,t.value)},s.prototype.compare=function(t){return n.compare(this.key,t.key)}},188:(t,e,r)=>{var n=r(930);function i(){throw new Error("Can't construct. GenericOrder is a mixin.")}t.exports=i,i.prototype.equals=function(t,e){return e=e||this.contentEquals||n.equals,this===t||!!t&&(this.length===t.length&&this.zip(t).every((function(t){return e(t[0],t[1])})))},i.prototype.compare=function(t,e){if(e=e||this.contentCompare||n.compare,this===t)return 0;if(!t)return 1;var r=Math.min(this.length,t.length),i=this.zip(t).reduce((function(t,n,i){return 0===t?i>=r?t:e(n[0],n[1]):t}),0);return 0===i?this.length-t.length:i},i.prototype.toJSON=function(){return this.toArray()}},900:t=>{function e(){throw new Error("Can't construct. GenericSet is a mixin.")}t.exports=e,e.prototype.isSet=!0,e.prototype.union=function(t){var e=this.constructClone(this);return e.addEach(t),e},e.prototype.intersection=function(t){return this.constructClone(this.filter((function(e){return t.has(e)})))},e.prototype.difference=function(t){var e=this.constructClone(this);return e.deleteEach(t),e},e.prototype.symmetricDifference=function(t){var e=this.union(t),r=this.intersection(t);return e.difference(r)},e.prototype.deleteAll=function(t){return+this.delete(t)},e.prototype.equals=function(t,e){var r=this;return t&&"function"==typeof t.reduce&&this.length===t.length&&t.reduce((function(t,n){return t&&r.has(n,e)}),!0)},e.prototype.forEach=function(t){var e=arguments[1];return this.reduce((function(r,n,i,o,s){t.call(e,n,n,o,s)}),void 0)},e.prototype.toJSON=function(){return this.toArray()},e.prototype.contains=function(t){return this.has(t)},e.prototype.remove=function(t){return this.delete(t)},e.prototype.toggle=function(t){this.has(t)?this.delete(t):this.add(t)};var r=function(t,e){return t};e.prototype.valuesArray=function(){return this.map(r)};var n=function(t,e){return[e,t]};e.prototype.entriesArray=function(){return this.map(n)}},582:(t,e,r)=>{"use strict";t.exports=o;var n=r(930),i=r(647);function o(t,e){var r=e&&t&&t.values&&t.values();if(r&&"function"==typeof r.next)return r;if(!(this instanceof o))return new o(t);if(Array.isArray(t)||"string"==typeof t)return o.iterate(t);if((t=n(t))instanceof o)return t;if(t.next)this.next=function(){return t.next()};else if(t.iterate){var i=t.iterate();this.next=function(){return i.next()}}else{if("[object Function]"!==n.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}o.prototype.forEach=i.prototype.forEach,o.prototype.map=i.prototype.map,o.prototype.filter=i.prototype.filter,o.prototype.every=i.prototype.every,o.prototype.some=i.prototype.some,o.prototype.any=i.prototype.any,o.prototype.all=i.prototype.all,o.prototype.min=i.prototype.min,o.prototype.max=i.prototype.max,o.prototype.sum=i.prototype.sum,o.prototype.average=i.prototype.average,o.prototype.flatten=i.prototype.flatten,o.prototype.zip=i.prototype.zip,o.prototype.enumerate=i.prototype.enumerate,o.prototype.sorted=i.prototype.sorted,o.prototype.group=i.prototype.group,o.prototype.reversed=i.prototype.reversed,o.prototype.toArray=i.prototype.toArray,o.prototype.toObject=i.prototype.toObject,o.prototype.iterator=i.prototype.iterator,o.prototype.__iterationObject=null,n.defineProperty(o.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:void 0})}}),o.prototype.constructClone=function(t){var e=[];return e.addEach(t),e},o.prototype.mapIterator=function(t){var e=o(this),r=arguments[1],i=0;if("[object Function]"!=n.prototype.toString.call(t))throw new TypeError;return new e.constructor((function(){if(!0!==e._iterationObject.done){var n=t.call(r,e.next().value,i++,e);e._iterationObject.value=n}return e._iterationObject}))},o.prototype.filterIterator=function(t){var e=o(this),r=arguments[1],i=0;if("[object Function]"!=n.prototype.toString.call(t))throw new TypeError;return new e.constructor((function(){for(var n;;){if(!0===(n=e.next()).done)return n;if(t.call(r,n.value,i++,e))return n}}))},o.prototype.reduce=function(t){var e,r=o(this),i=arguments[1],s=arguments[2],a=0;if("[object Function]"!=n.prototype.toString.call(t))throw new TypeError;if(!0===(e=r.next()).done){if(arguments.length>1)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(i=arguments.length>1?t.call(s,i,e.value,a,r):e.value,a++;;){if(!0===(e=r.next()).done)return i;i=t.call(s,i,e.value,a,r),a++}},o.prototype.concat=function(){return o.concat(Array.prototype.concat.apply(this,arguments))},o.prototype.dropWhile=function(t){var e,r,i=o(this),s=arguments[1],a=!1,h=0;if("[object Function]"!=n.prototype.toString.call(t))throw new TypeError;for(;!0!==(r=i.next()).done;){if(!t.call(s,r.value,h,i)){a=!0,e=r.value;break}h++}return a?i.constructor([e]).concat(i):i.constructor([])},o.prototype.takeWhile=function(t){var e=o(this),r=arguments[1],i=0;if("[object Function]"!=n.prototype.toString.call(t))throw new TypeError;return new e.constructor((function(){if(!0!==e._iterationObject.done){var n=e.next().value;t.call(r,n,i++,e)?e._iterationObject.value=n:(e._iterationObject.done=!0,e._iterationObject.value=void 0)}return e._iterationObject}))},o.prototype.zipIterator=function(){return o.unzip(Array.prototype.concat.apply(this,arguments))},o.prototype.enumerateIterator=function(t){return o.count(t).zipIterator(this)},o.iterate=function(t){var e;return e=0,new o((function(){if("object"==typeof t)for(;!(e in t);){if(e>=t.length){this._iterationObject.done=!0,this._iterationObject.value=void 0;break}e+=1}else e>=t.length&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);return this._iterationObject.done||(this._iterationObject.value=t[e],e+=1),this._iterationObject}))},o.cycle=function(t,e){var r;return arguments.length<2&&(e=1/0),new o((function(){var n,i;return r&&(i=r()),r&&!0!==i.done||(e>0?(e--,n=o.iterate(t),i=(r=n.next.bind(n))()):(this._iterationObject.done=!0,i=this._iterationObject)),i}))},o.concat=function(t){var e;return t=o(t),new o((function(){var r,n;return e&&(n=e()),n&&!0!==n.done?n:!1===(n=t.next()).done?(r=o(n.value),(e=r.next.bind(r))()):n}))},o.unzip=function(t){return 0===(t=o(t).map(o)).length?new o([]):new o((function(){var e,r,n=t.map((function(t){return!0===(r=t.next()).done&&(e=!0),r.value}));return e?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=n,this._iterationObject}))},o.zip=function(){return o.unzip(Array.prototype.slice.call(arguments))},o.chain=function(){return o.concat(Array.prototype.slice.call(arguments))},o.range=function(t,e,r){return arguments.length<3&&(r=1),arguments.length<2&&(e=t,t=0),t=t||0,r=r||1,new o((function(){t>=e&&(this._iterationObject.done=!0,this._iterationObject.value=void 0);var n=t;return t+=r,this._iterationObject.value=n,this._iterationObject}))},o.count=function(t,e){return o.range(t,1/0,e)},o.repeat=function(t,e){return new o.range(e).mapIterator((function(){return t}))}},193:(t,e,r)=>{var n=r(556),i=t.exports.ObjectChangeDescriptor=function(t){return this.name=t,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null,this};Object.defineProperties(i.prototype,{name:{value:null,writable:!0},isActive:{value:!1,writable:!0},_willChangeListeners:{value:null,writable:!0},willChangeListeners:{get:function(){return this._willChangeListeners||(this._willChangeListeners=new this.willChangeListenersRecordConstructor(this.name))}},_changeListeners:{value:null,writable:!0},changeListeners:{get:function(){return this._changeListeners||(this._changeListeners=new this.changeListenersRecordConstructor(this.name))}},changeListenersRecordConstructor:{value:a,writable:!0},willChangeListenersRecordConstructor:{value:c,writable:!0}});var o=t.exports.ListenerGhost=Object.create(null),s=new n;function a(t){var e=s.get(t);return e||(e="handle",e+=t,e+="Change",s.set(t,e)),this._current=null,this._current=null,this.specificHandlerMethodName=e,this}t.exports.ChangeListenersRecord=a,Object.defineProperties(a.prototype,{_current:{value:null,writable:!0},current:{get:function(){return this._current},set:function(t){this._current=t}},ListenerGhost:{value:o,writable:!0},ghostCount:{value:0,writable:!0},maxListenerGhostRatio:{value:.3,writable:!0},listenerGhostFilter:{value:function(t){return t!==this.ListenerGhost}},removeCurrentGostListenersIfNeeded:{value:function(){return this._current&&this.ghostCount/this._current.length>this.maxListenerGhostRatio&&(this.ghostCount=0,this._current=this._current.filter(this.listenerGhostFilter,this)),this._current}},dispatchBeforeChange:{value:!1,writable:!0},genericHandlerMethodName:{value:"handlePropertyChange",writable:!0}}),t.exports.WillChangeListenersRecord=c;var h=new n;function c(t){var e=h.get(t);return e||(e="handle",e+=t,e+="WillChange",h.set(t,e)),this.specificHandlerMethodName=e,this}c.prototype=new a,c.prototype.constructor=c,c.prototype.genericHandlerMethodName="handlePropertyWillChange"},554:(t,e,r)=>{"use strict";var n=r(114),i=r(556),o=r(193),s=o.ObjectChangeDescriptor,a=o.ChangeListenersRecord,h=o.ListenerGhost;function c(){throw new Error("Can't construct. MapChanges is a mixin.")}t.exports=c,Object.prototype.hasOwnProperty;var u=new n;function l(t){this.name=t,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null}l.prototype=new s,l.prototype.constructor=l,l.prototype.changeListenersRecordConstructor=f,l.prototype.willChangeListenersRecordConstructor=g;var p=new i;function f(t){var e=p.get(t);return e||(e="handle",e+=t.slice(0,1).toUpperCase(),e+=t.slice(1),e+="MapChange",p.set(t,e)),this.specificHandlerMethodName=e,this}f.prototype=new a,f.prototype.constructor=f,f.prototype.genericHandlerMethodName="handleMapChange";var d=new i;function g(t){var e=d.get(t);return e||(e="handle",e+=t.slice(0,1).toUpperCase(),e+=t.slice(1),e+="MapWillChange",d.set(t,e)),this.specificHandlerMethodName=e,this}g.prototype=new a,g.prototype.constructor=g,g.prototype.genericHandlerMethodName="handleMapWillChange",c.prototype.getAllMapChangeDescriptors=function(){return u.has(this)||u.set(this,new i),u.get(this)},c.prototype.getMapChangeDescriptor=function(t){var e=this.getAllMapChangeDescriptors();return t=t||"",e.has(t)||e.set(t,new l(t)),e.get(t)};var y=new n,v="dispatchesMapChanges",m={get:function(){return y.get(this)},set:function(t){return y.set(this,t)},configurable:!0,enumerable:!1};c.prototype.addMapChangeListener=function(t,e,r){!this.isObservable&&this.makeObservable&&this.makeObservable();var n,i=this.getMapChangeDescriptor(e);(n=r?i.willChangeListeners:i.changeListeners)._current?Array.isArray(n._current)?n._current.push(t):n._current=[n._current,t]:n._current=t,void 0===Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),v)&&Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),v,m),this.dispatchesMapChanges=!0;var o=this;return function(){o&&(o.removeMapChangeListener(t,e,r),o=null)}},c.prototype.removeMapChangeListener=function(t,e,r){var n,i=this.getMapChangeDescriptor(e);if((n=r?i.willChangeListeners:i.changeListeners)._current)if(n._current===t)n._current=null;else{var o=n._current.lastIndexOf(t);if(-1===o)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(e));i.isActive?(n.ghostCount=n.ghostCount+1,n._current[o]=h):n._current.spliceOne(o)}},c.prototype.dispatchMapChange=function(t,e,r){var n=this.getAllMapChangeDescriptors(),i=h;n.forEach((function(n,o){if(!n.isActive){var s=r?n.willChangeListeners:n.changeListeners;if(s&&s._current){var a=s.specificHandlerMethodName;if(Array.isArray(s._current)){if(s._current.length){var h,c,u,l=s.removeCurrentGostListenersIfNeeded();n.isActive=!0;try{for(h=0,c=l.length;h<c;h++)if((u=l[h])!==i)if(u[a])u[a](e,t,this);else{if(!u.call)throw new Error("Handler "+u+" has no method "+a+" and is not callable");u.call(u,e,t,this)}}finally{n.isActive=!1}}}else{n.isActive=!0;try{if((u=s._current)[a])u[a](e,t,this);else{if(!u.call)throw new Error("Handler "+u+" has no method "+a+" and is not callable");u.call(u,e,t,this)}}finally{n.isActive=!1}}}}}),this)},c.prototype.addBeforeMapChangeListener=function(t,e){return this.addMapChangeListener(t,e,!0)},c.prototype.removeBeforeMapChangeListener=function(t,e){return this.removeMapChangeListener(t,e,!0)},c.prototype.dispatchBeforeMapChange=function(t,e){return this.dispatchMapChange(t,e,!0)}},298:(t,e,r)=>{function n(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}Object.prototype.hasOwnProperty,t.exports=n,r(126);var i=r(556),o=r(114),s=r(193),a=s.ObjectChangeDescriptor,h=s.ListenerGhost;n.debug=!0;var c=new o,u=new i;function l(t,e,r,n){if(t&&t._current){var i,o,s,a,c,u=t.specificHandlerMethodName,l=t.genericHandlerMethodName,p=h;if(Array.isArray(t._current)){for(s=0,a=(i=t.removeCurrentGostListenersIfNeeded()).length;s<a;s++)if((c=i[s])!==p){if(!(o=c[u]||c[l]||c).call)throw new Error("No event listener for "+t.specificHandlerName+" or "+t.genericHandlerName+" or call on "+o);o.call(c,r,e,n)}}else{if(!(o=(c=t._current)[u]||c[l]||c).call)throw new Error("No event listener for "+t.specificHandlerName+" or "+t.genericHandlerName+" or call on "+o);o.call(c,r,e,n)}}}n.ObjectChangeDescriptor=function(){},n.prototype.getOwnPropertyChangeDescriptor=function(t){var e,r=c.get(this);if(r||(r=Object.create(null),c.set(this,r)),void 0===(e=r[t])){var n=u.get(t);return n||(n=(n=String(t))&&n[0].toUpperCase()+n.slice(1),u.set(t,n)),r[t]=new a(n)}return e},n.prototype.hasOwnPropertyChangeDescriptor=function(t){var e=c.get(this);return!(!e||t&&void 0===e[t])},n.prototype.addOwnPropertyChangeListener=function(t,e,r){this.makeObservable&&!this.isObservable&&this.makeObservable();var i=n.getOwnPropertyChangeDescriptor(this,t),o=r?i.willChangeListeners:i.changeListeners;n.makePropertyObservable(this,t),o._current?Array.isArray(o._current)?o._current.push(e):o._current=[o._current,e]:o._current=e;var s=this;return function(){n.removeOwnPropertyChangeListener(s,t,e,r),s=null}},n.prototype.addBeforeOwnPropertyChangeListener=function(t,e){return n.addOwnPropertyChangeListener(this,t,e,!0)},n.prototype.removeOwnPropertyChangeListener=function t(e,r,i){var o,s=n.getOwnPropertyChangeDescriptor(this,e);if((o=i?s._willChangeListeners:s._changeListeners)&&o._current)if(o._current===r)o._current=null;else{var a=o._current.lastIndexOf(r);if(-1===a)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(e));s.isActive?(o.ghostCount=o.ghostCount+1,o._current[a]=t.ListenerGhost):o._current.spliceOne(a)}},n.prototype.removeOwnPropertyChangeListener.ListenerGhost=h,n.prototype.removeBeforeOwnPropertyChangeListener=function(t,e){return n.removeOwnPropertyChangeListener(this,t,e,!0)},n.prototype.dispatchOwnPropertyChange=function t(e,r,i){var o,s=n.getOwnPropertyChangeDescriptor(this,e);if(!s.isActive){s.isActive=!0,o=i?s._willChangeListeners:s._changeListeners;try{t.dispatchEach(o,e,r,this)}finally{s.isActive=!1}}},n.prototype.dispatchOwnPropertyChange.dispatchEach=l,l.ListenerGhost=h,n.prototype.dispatchBeforeOwnPropertyChange=function(t,e){return n.dispatchOwnPropertyChange(this,t,e,!0)};var p=new o,f=(new o,{get:void 0,set:void 0,configurable:!0,enumerable:!1});n.prototype.makePropertyObservable=function(t){var e=p.get(this);if(!e||void 0===e.get(t)){if(!e){if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(t)+" observable on "+this+" because object is not extensible");e=new i,p.set(this,e)}var r,n=this;do{if(r=Object.getOwnPropertyDescriptor(n,t))break;n=Object.getPrototypeOf(n)}while(n);if(r){if(!r.configurable)return;if(!r.writable&&!r.set)return}else r={value:void 0,enumerable:!0,writable:!0,configurable:!0};e.set(t,r),"value"in r?(f.get=function t(){return t.overriddenDescriptor.value},f.set=function t(e){var r,n,i=t.overriddenDescriptor;if(e!==i.value){if(!(n=(r=t.descriptor).isActive)){r.isActive=!0;try{t.dispatchEach(r._willChangeListeners,t.key,i.value,this)}finally{}}if(i.value=e,!n)try{t.dispatchEach(r._changeListeners,t.key,e,this)}finally{r.isActive=!1}}},f.set.dispatchEach=l,f.set.key=t,f.get.overriddenDescriptor=f.set.overriddenDescriptor=r,f.set.descriptor=c.get(this)[t],f.enumerable=r.enumerable,f.configurable=!0):(f.get=r.get,f.set=function e(){var r,n,i,o=e.overriddenGetter.call(this);if(1===arguments.length?e.overriddenSetter.call(this,arguments[0]):2===arguments.length?e.overriddenSetter.call(this,arguments[0],arguments[1]):e.overriddenSetter.apply(this,arguments),(i=e.overriddenGetter.call(this))!==o){if(!(n=(r=e.descriptor).isActive)){r.isActive=!0;try{e.dispatchEach(r._willChangeListeners,t,o,this)}finally{}}if(!n)try{e.dispatchEach(r._changeListeners,t,i,this)}finally{r.isActive=!1}}},f.enumerable=r.enumerable,f.configurable=!0,f.set.dispatchEach=l,f.set.overriddenSetter=r.set,f.set.overriddenGetter=r.get,f.set.descriptor=c.get(this)[t]),Object.defineProperty(this,t,f)}},n.getOwnPropertyChangeDescriptor=function(t,e){return t.getOwnPropertyChangeDescriptor?t.getOwnPropertyChangeDescriptor(e):n.prototype.getOwnPropertyChangeDescriptor.call(t,e)},n.hasOwnPropertyChangeDescriptor=function(t,e){return t.hasOwnPropertyChangeDescriptor?t.hasOwnPropertyChangeDescriptor(e):n.prototype.hasOwnPropertyChangeDescriptor.call(t,e)},n.addOwnPropertyChangeListener=function(t,e,r,n){if(Object.isObject(t))return t.addOwnPropertyChangeListener?t.addOwnPropertyChangeListener(e,r,n):this.prototype.addOwnPropertyChangeListener.call(t,e,r,n)},n.removeOwnPropertyChangeListener=function(t,e,r,i){if(Object.isObject(t))return t.removeOwnPropertyChangeListener?t.removeOwnPropertyChangeListener(e,r,i):n.prototype.removeOwnPropertyChangeListener.call(t,e,r,i)},n.dispatchOwnPropertyChange=function(t,e,r,i){if(Object.isObject(t))return t.dispatchOwnPropertyChange?t.dispatchOwnPropertyChange(e,r,i):n.prototype.dispatchOwnPropertyChange.call(t,e,r,i)},n.addBeforeOwnPropertyChangeListener=function(t,e,r){return n.addOwnPropertyChangeListener(t,e,r,!0)},n.removeBeforeOwnPropertyChangeListener=function(t,e,r){return n.removeOwnPropertyChangeListener(t,e,r,!0)},n.dispatchBeforeOwnPropertyChange=function(t,e,r){return n.dispatchOwnPropertyChange(t,e,r,!0)},n.makePropertyObservable=function(t,e){return t.makePropertyObservable?t.makePropertyObservable(e):n.prototype.makePropertyObservable.call(t,e)}},226:(t,e,r)=>{"use strict";var n=r(114),i=r(556),o=r(193),s=o.ObjectChangeDescriptor,a=o.ChangeListenersRecord,h=o.ListenerGhost,c=new n;function u(t){this.name=t,this.isActive=!1,this._willChangeListeners=null,this._changeListeners=null}u.prototype=new s,u.prototype.constructor=u,u.prototype.changeListenersRecordConstructor=p,u.prototype.willChangeListenersRecordConstructor=d,Object.defineProperty(u.prototype,"active",{get:function(){return this._active||(this._active=this._current?this._current.slice():[])}});var l=new i;function p(t){var e=l.get(t);return e||(e="handle",e+=t.slice(0,1).toUpperCase(),e+=t.slice(1),e+="RangeChange",l.set(t,e)),this.specificHandlerMethodName=e,this}p.prototype=new a,p.prototype.constructor=p;var f=new i;function d(t){var e=f.get(t);return e||(e="handle",e+=t.slice(0,1).toUpperCase(),e+=t.slice(1),e+="RangeWillChange",f.set(t,e)),this.specificHandlerMethodName=e,this}function g(){throw new Error("Can't construct. RangeChanges is a mixin.")}d.prototype=new a,d.prototype.constructor=d,t.exports=g,g.prototype.getAllRangeChangeDescriptors=function(){return c.has(this)||c.set(this,new i),c.get(this)},g.prototype.getRangeChangeDescriptor=function(t){var e=this.getAllRangeChangeDescriptors();return t=t||"",e.has(t)||e.set(t,new u(t)),e.get(t)};var y=new n,v="dispatchesRangeChanges",m={get:function(){return y.get(this)},set:function(t){return y.set(this,t)},configurable:!0,enumerable:!1};g.prototype.addRangeChangeListener=function(t,e,r){!this.isObservable&&this.makeObservable&&this.makeObservable();var n,i=this.getRangeChangeDescriptor(e);(n=r?i.willChangeListeners:i.changeListeners)._current?Array.isArray(n._current)?n._current.push(t):n._current=[n._current,t]:n._current=t,void 0===Object.getOwnPropertyDescriptor(this.__proto__||Object.getPrototypeOf(this),v)&&Object.defineProperty(this.__proto__||Object.getPrototypeOf(this),v,m),this.dispatchesRangeChanges=!0;var o=this;return function(){o&&(o.removeRangeChangeListener(t,e,r),o=null)}},g.prototype.removeRangeChangeListener=function(t,e,r){var n,i=this.getRangeChangeDescriptor(e);if((n=r?i._willChangeListeners:i._changeListeners)._current)if(n._current===t)n._current=null;else{var o=n._current.lastIndexOf(t);if(-1===o)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(e));i.isActive?(n.ghostCount=n.ghostCount+1,n._current[o]=h):n._current.spliceOne(o)}},g.prototype.dispatchRangeChange=function(t,e,r,n){var i,o,s,a,c,u,l,p,f=this.getAllRangeChangeDescriptors(),d=f.values();for(f.dispatchBeforeChange=n;i=d.next().value;){if(i.isActive)return;if((o=n?i._willChangeListeners:i._changeListeners)&&o._current)if(s=o.specificHandlerMethodName,Array.isArray(o._current)){if(o._current.length){i.isActive=!0;try{for(l=o.removeCurrentGostListenersIfNeeded(),p=h,a=0,c=l.length;a<c;a++)if((u=l[a])!==p)if(u[s])u[s](t,e,r,this,n);else{if(!u.call)throw new Error("Handler "+u+" has no method "+s+" and is not callable");u.call(this,t,e,r,this,n)}}finally{i.isActive=!1}}}else{i.isActive=!0;try{if((u=o._current)[s])u[s](t,e,r,this,n);else{if(!u.call)throw new Error("Handler "+u+" has no method "+s+" and is not callable");u.call(this,t,e,r,this,n)}}finally{i.isActive=!1}}}},g.prototype.addBeforeRangeChangeListener=function(t,e){return this.addRangeChangeListener(t,e,!0)},g.prototype.removeBeforeRangeChangeListener=function(t,e){return this.removeRangeChangeListener(t,e,!0)},g.prototype.dispatchBeforeRangeChange=function(t,e,r){return this.dispatchRangeChange(t,e,r,!0)}},466:(t,e,r)=>{"use strict";var n=r(556),i=r(298),o=r(554);t.exports=n,void 0===r.g.Map||"function"!=typeof r.g.Set.prototype.values?(Object.addEach(n.prototype,i.prototype),Object.addEach(n.prototype,o.prototype)):(Object.defineEach(n.prototype,i.prototype,!1,!0,!1,!0),Object.defineEach(n.prototype,o.prototype,!1,!0,!1,!0))},943:(t,e,r)=>{"use strict";r(449);var n=r(647),i=r(188),o=r(114);t.exports=Array;var s=Array.prototype.splice,a=Array.prototype.slice;Array.empty||(Array.empty=[],Object.freeze&&Object.freeze(Array.empty)),Array.nativeFrom||(Array.nativeFrom=Array.from);var h="undefined"!=typeof Symbol;function c(t,e){Object.defineProperty(Array.prototype,t,{value:e,writable:!0,configurable:!0,enumerable:!1})}Array.from=function(t,e,r){if(h&&t&&("function"==typeof t[Symbol.iterator]||"function"==typeof e))return Array.nativeFrom(t,e,r);var n=[];return n.addEach(t),n},Array.unzip=function(t){for(var e=[],r=1/0,n=0;n<t.length;n++){var i=t[n];t[n]=i.toArray(),i.length<r&&(r=i.length)}for(n=0;n<t.length;n++){i=t[n];for(var o=0;o<i.length;o++)o<r&&o in i&&(e[o]=e[o]||[],e[o][n]=i[o])}return e},c("addEach",n.prototype.addEach),c("deleteEach",n.prototype.deleteEach),c("toArray",n.prototype.toArray),c("toObject",n.prototype.toObject),c("all",n.prototype.all),c("any",n.prototype.any),c("min",n.prototype.min),c("max",n.prototype.max),c("sum",n.prototype.sum),c("average",n.prototype.average),c("only",n.prototype.only),c("flatten",n.prototype.flatten),c("zip",n.prototype.zip),c("enumerate",n.prototype.enumerate),c("group",n.prototype.group),c("sorted",n.prototype.sorted),c("reversed",n.prototype.reversed),c("constructClone",(function(t){var e=new this.constructor;return e.addEach(t),e})),c("has",(function(t,e){return-1!==this.findValue(t,e)})),c("get",(function(t,e){if(+t!==t)throw new Error("Indicies must be numbers");return!t in this?e:this[t]})),c("set",(function(t,e){return this[t]=e,!0})),c("add",(function(t){return this.push(t),!0})),c("delete",(function(t,e){var r=this.findValue(t,e);return-1!==r&&(this.spliceOne(r),!0)})),c("deleteAll",(function(t,e){e=e||this.contentEquals||Object.equals;for(var r=0,n=0;n<this.length;)e(t,this[n])?(this.swap(n,1),r++):n++;return r})),Array.prototype.find||c("find",(function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],i=0;i<r;){var o=e[i];if(t.call(n,o,i,e))return o;i++}}));var u={};function l(t,e){"undefined"!=typeof console&&"function"==typeof console.warn&&!0!==e&&!1===u.hasOwnProperty(t)&&(console.warn(t),u[t]++)}var p=Object.getOwnPropertyDescriptor(Array.prototype,"find").value;function f(t,e,r){this.array=t,this.start=null==e?0:e,this.end=r}c("find",(function(t,e,r){return"function"==typeof arguments[0]&&this instanceof Array?p.apply(this,arguments):(l("Array#find usage is deprecated please use Array#findValue"),this.findValue.apply(this,arguments))})),c("findValue",(function(t,e,r){if(r)throw new Error("Array#findValue does not support third argument: index");for(e=e||this.contentEquals||Object.equals,r=0;r<this.length;r++)if(r in this&&e(t,this[r]))return r;return-1})),c("findLast",(function(t,e){return l("Array#findLast function is deprecated please use Array#findLastValue instead."),this.findLastValue.apply(this,arguments)})),c("findLastValue",(function(t,e){e=e||this.contentEquals||Object.equals;var r=this.length;do{if(--r in this&&e(this[r],t))return r}while(r>0);return-1})),c("swap",(function(t,e,r){var n,i,o,h,c;if(t>this.length&&(this.length=t),void 0!==r){if(n=[t,e],Array.isArray(r)||(r=a.call(r)),o=0,(i=r.length)<1e3){for(;o<i;o++)n[o+2]=r[o];return s.apply(this,n)}for(c=s.apply(this,n);o<i;){for(n=[t+o,0],h=2;h<1002&&o<i;h++,o++)n[h]=r[o];s.apply(this,n)}return c}return void 0!==e?s.call(this,t,e):void 0!==t?s.call(this,t):[]})),c("peek",(function(){return this[0]})),c("poke",(function(t){this.length>0&&(this[0]=t)})),c("peekBack",(function(){if(this.length>0)return this[this.length-1]})),c("pokeBack",(function(t){this.length>0&&(this[this.length-1]=t)})),c("one",(function(){for(var t in this)if(Object.owns(this,t))return this[t]})),Array.prototype.clear||c("clear",(function(){return this.length=0,this})),c("compare",(function(t,e){var r,n,o;if(e=e||Object.compare,this===t)return 0;if(!t||!Array.isArray(t))return i.prototype.compare.call(this,t,e);for(n=this.length<t.length?this.length:t.length,r=0;r<n;r++)if(r in this){if(!(r in t))return-1;if(o=e(this[r],t[r]))return o}else if(r in t)return 1;return this.length-t.length})),c("equals",(function(t,e){e=e||Object.equals;var r=0,n=this.length;if(this===t)return!0;if(!t||!Array.isArray(t))return i.prototype.equals.call(this,t);if(n!==t.length)return!1;for(;r<n;++r)if(r in this){if(!(r in t))return!1;if(!e(this[r],t[r]))return!1}else if(r in t)return!1;return!0})),c("clone",(function(t,e){if(null==t)t=1/0;else if(0===t)return this;if((e=e||new o).has(this))return e.get(this);var r=new Array(this.length);for(var n in e.set(this,r),this)r[n]=Object.clone(this[n],t-1,e);return r})),c("iterate",(function(t,e){return new f(this,t,e)})),void 0===Array.prototype.spliceOne&&c("spliceOne",(function(t,e){var r=this.length;if(r)if(1===arguments.length){for(;t<r;)this[t]=this[t+1],t++;this.length--}else this[t]=e})),c("Iterator",f),f.prototype.__iterationObject=null,Object.defineProperty(f.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),f.prototype.next=function(){return this.start===(null==this.end?this.array.length:this.end)?(this._iterationObject.done=!0,this._iterationObject.value=void 0):this._iterationObject.value=this.array[this.start++],this._iterationObject}},449:t=>{t.exports=Function,Function.noop=function(){},Function.identity=function(t){return t},Function.by=function(t,e){e=e||Object.compare,t=t||Function.identity;var r=function(r,n){return e(t(r),t(n))};return r.compare=e,r.by=t,r},Function.get=function(t){return function(e){return Object.get(e,t)}}},930:(t,e,r)=>{"use strict";var n=r(114);r(449),t.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.isObject=function(t){return Object(t)===t},Object.getValueOf=function(t){return t&&"function"==typeof t.valueOf&&(t=t.valueOf()),t};var i=new n;Object.hash=function(t){return t&&"function"==typeof t.hash?""+t.hash():Object(t)===t?(i.has(t)||i.set(t,Math.random().toString(36).slice(2)),i.get(t)):""+t};var o=Object.prototype.hasOwnProperty;Object.owns=function(t,e){return o.call(t,e)},Object.has=function(t,e){if("object"!=typeof t)throw new Error("Object.has can't accept non-object: "+typeof t);if(t&&"function"==typeof t.has)return t.has(e);if("string"==typeof e)return e in t&&t[e]!==Object.prototype[e];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(t,e,r){if("object"!=typeof t)throw new Error("Object.get can't accept non-object: "+typeof t);return t&&"function"==typeof t.get?t.get(e,r):Object.has(t,e)?t[e]:r},Object.set=function(t,e,r){t&&"function"==typeof t.set?t.set(e,r):t[e]=r},Object.addEach=function(t,e,r){var n=3!==arguments.length||r;if(e)if("function"!=typeof e.forEach||e.hasOwnProperty("forEach"))if("number"==typeof e.length)for(var i=0;i<e.length;i++)t[i]=e[i];else for(var o,s=Object.keys(e),a=0;o=s[a];a++)!n&&Object.owns(t,o)||(t[o]=e[o]);else!0===e.isMap?e.forEach((function(e,r){t[r]=e})):e.forEach((function(e){t[e[0]]=e[1]}));return t},Object.defineEach=function(t,e,r,n,i,o){var s=3!==arguments.length||r;if(e)if("function"!=typeof e.forEach||e.hasOwnProperty("forEach"))if("number"==typeof e.length)for(var a=0;a<e.length;a++)Object.defineProperty(t,a,{value:e[a],writable:o,configurable:n,enumerable:i});else for(var h,c=Object.keys(e),u=0;h=c[u];u++)!s&&Object.owns(t,h)||Object.defineProperty(t,h,{value:e[h],writable:o,configurable:n,enumerable:i});else!0===e.isMap?e.forEach((function(e,r){Object.defineProperty(t,r,{value:e,writable:o,configurable:n,enumerable:i})})):e.forEach((function(e){Object.defineProperty(t,e[0],{value:e[1],writable:o,configurable:n,enumerable:i})}));return t},Object.forEach=function(t,e,r){for(var n,i=Object.keys(t),o=0;n=i[o];o++)e.call(r,t[n],n,t)},Object.map=function(t,e,r){for(var n,i=Object.keys(t),o=0,s=[];n=i[o];o++)s.push(e.call(r,t[n],n,t));return s},Object.values=function(t){return Object.map(t,Function.identity)},Object.concat=function(){for(var t={},e=0;e<arguments.length;e++)Object.addEach(t,arguments[e]);return t},Object.from=Object.concat,Object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},Object.equals=function(t,e,r,i){if(r=r||Object.equals,(t=Object.getValueOf(t))===(e=Object.getValueOf(e)))return!0;if(Object.isObject(t)){if((i=i||new n).has(t))return!0;i.set(t,!0)}if(Object.isObject(t)&&"function"==typeof t.equals)return t.equals(e,r,i);if(Object.isObject(e)&&"function"==typeof e.equals)return e.equals(t,r,i);if(Object.isObject(t)&&Object.isObject(e)&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){for(var o in t)if(!r(t[o],e[o],r,i))return!1;for(var o in e)if(!(o in t)||!r(e[o],t[o],r,i))return!1;return!0}return t!=t&&e!=e||(!t||!e)&&t===e},Object.compare=function(t,e){if((t=Object.getValueOf(t))===(e=Object.getValueOf(e)))return 0;var r=typeof t,n=typeof e;return"number"===r&&"number"===n?t-e:"string"===r&&"string"===n?t<e?-1/0:1/0:t&&"function"==typeof t.compare?t.compare(e):e&&"function"==typeof e.compare?-e.compare(t):0},Object.clone=function(t,e,r){if(t=Object.getValueOf(t),r=r||new n,void 0===e)e=1/0;else if(0===e)return t;if(Object.isObject(t)){if(!r.has(t))if(t&&"function"==typeof t.clone)r.set(t,t.clone(e,r));else{var i=Object.getPrototypeOf(t);if(null!==i&&i!==Object.prototype)throw new Error("Can't clone "+t);var o=Object.create(i);for(var s in r.set(t,o),t)o[s]=Object.clone(t[s],e-1,r)}return r.get(t)}return t},Object.clear=function(t){if(t&&"function"==typeof t.clear)t.clear();else for(var e=Object.keys(t),r=e.length;r;)delete t[e[--r]];return t}},764:()=>{if(!RegExp.escape){var t=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(e){return e.replace(t,"\\$&")}}},126:(t,e,r)=>{r(943),r(930),r(449),r(764)},50:(t,e,r)=>{"use strict";t.exports=h,r(126);var n=r(647),i=r(900),o=r(298),s=r(226),a=r(312);function h(t,e,r,n){if(!(this instanceof h))return new h(t,e,r,n);this.contentEquals=e||Object.equals,this.contentCompare=r||Object.compare,this.getDefault=n||Function.noop,this.root=null,this.length=0,this.addEach(t)}function c(t){this.value=t,this.left=null,this.right=null,this.length=1}function u(t,e,r){if(this.set=t,this.prev=null,this.end=r,e){var n=this.set.findLeastGreaterThanOrEqual(e);n&&(this.set.splay(n.value),this.prev=n.getPrevious())}}h.SortedSet=h,Object.addEach(h.prototype,n.prototype),Object.addEach(h.prototype,i.prototype),Object.addEach(h.prototype,o.prototype),Object.addEach(h.prototype,s.prototype),Object.defineProperty(h.prototype,"size",n._sizePropertyDescriptor),h.from=n.from,h.prototype.isSorted=!0,h.prototype.constructClone=function(t){return new this.constructor(t,this.contentEquals,this.contentCompare,this.getDefault)},h.prototype.has=function(t,e){if(e)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.splay(t),this.contentEquals(t,this.root.value))},h.prototype.get=function(t,e){if(e)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.splay(t),this.contentEquals(t,this.root.value))?this.root.value:this.getDefault(t)},h.prototype.add=function(t){var e=new this.Node(t);if(!this.root)return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([t],[],0),this.root=e,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([t],[],0),!0;if(this.splay(t),!this.contentEquals(t,this.root.value)){var r=this.contentCompare(t,this.root.value);if(0===r)throw new Error("SortedSet cannot contain incomparable but inequal values: "+t+" and "+this.root.value);return this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([t],[],this.root.index),r<0?(e.right=this.root,e.left=this.root.left,this.root.left=null,this.root.touch()):(e.left=this.root,e.right=this.root.right,this.root.right=null,this.root.touch()),e.touch(),this.root=e,this.length++,this.dispatchesRangeChanges&&this.dispatchRangeChange([t],[],this.root.index),!0}return!1},h.prototype.delete=function(t,e){if(e)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.splay(t),this.contentEquals(t,this.root.value))){var r=this.root.index;if(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[t],r),this.root.left){var n=this.root.right;this.root=this.root.left,this.splay(t),this.root.right=n}else this.root=this.root.right;return this.length--,this.root&&this.root.touch(),this.dispatchesRangeChanges&&this.dispatchRangeChange([],[t],r),!0}return!1},h.prototype.indexOf=function(t,e){if(e)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.splay(t),this.contentEquals(t,this.root.value))?this.root.index:-1},h.prototype.find=function(t,e,r){if(e)throw new Error("SortedSet#find does not support second argument: equals");if(r)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.splay(t),this.contentEquals(t,this.root.value)))return this.root},h.prototype.findGreatest=function(t){if(this.root){for(t=t||this.root;t.right;)t=t.right;return t}},h.prototype.findLeast=function(t){if(this.root){for(t=t||this.root;t.left;)t=t.left;return t}},h.prototype.findGreatestLessThanOrEqual=function(t){if(this.root)return this.splay(t),this.contentCompare(this.root.value,t)>0?this.root.getPrevious():this.root},h.prototype.findGreatestLessThan=function(t){if(this.root)return this.splay(t),this.contentCompare(this.root.value,t)>=0?this.root.getPrevious():this.root},h.prototype.findLeastGreaterThanOrEqual=function(t){if(this.root)return this.splay(t),this.contentCompare(this.root.value,t)>=0?this.root:this.root.getNext()},h.prototype.findLeastGreaterThan=function(t){if(this.root)return this.splay(t),this.contentCompare(this.root.value,t)<=0?this.root.getNext():this.root},h.prototype.pop=function(){if(this.root){var t=this.findGreatest();return this.delete(t.value),t.value}},h.prototype.shift=function(){if(this.root){var t=this.findLeast();return this.delete(t.value),t.value}},h.prototype.push=function(){this.addEach(arguments)},h.prototype.unshift=function(){this.addEach(arguments)},h.prototype.slice=function(t,e){t=t||0,e=e||this.length,t<0&&(t+=this.length),e<0&&(e+=this.length);var r=[];if(this.root)for(this.splayIndex(t);this.root.index<e&&(r.push(this.root.value),this.root.right);)this.splay(this.root.getNext().value);return r},h.prototype.splice=function(t,e){return this.swap(t,e,Array.prototype.slice.call(arguments,2))},h.prototype.swap=function(t,e,r){if(void 0===t&&void 0===e)return[];(t=t||0)<0&&(t+=this.length),void 0===e&&(e=1/0);var n=[];if(this.root){this.splayIndex(t);for(var i=0;i<e;i++){n.push(this.root.value);var o=this.root.getNext();if(this.delete(this.root.value),!o)break;this.splay(o.value)}}return this.addEach(r),n},h.prototype.splay=function(t){var e,r,n,i,o,s;if(this.root){for(e=r=n=new this.Node,s=new this.Node,o=this.root;;){var a=this.contentCompare(t,o.value);if(a<0){if(!o.left)break;if(this.contentCompare(t,o.left.value)<0&&(i=o.left,o.left=i.right,o.touch(),i.right=o,i.touch(),!(o=i).left))break;(i=new c).right=o,i.left=s.left,s.left=i,n.left=o,n.touch(),n=o,o=o.left}else{if(!(a>0))break;if(!o.right)break;if(this.contentCompare(t,o.right.value)>0&&(i=o.right,o.right=i.left,o.touch(),i.left=o,i.touch(),!(o=i).right))break;(i=new c).left=o,i.right=s.right,s.right=i,r.right=o,r.touch(),r=o,o=o.right}}for(r.right=o.left,r.touch(),n.left=o.right,n.touch(),o.left=e.right,o.right=e.left;s.left;)s.left.right.touch(),s.left=s.left.left;for(;s.right;)s.right.left.touch(),s.right=s.right.right;o.touch(),this.root=o}},h.prototype.splayIndex=function(t){if(this.root){for(var e=this.root,r=this.root.index;r!==t;)if(r>t&&e.left)r-=1+((e=e.left).right?e.right.length:0);else{if(!(r<t&&e.right))break;r+=1+((e=e.right).left?e.left.length:0)}return this.splay(e.value),this.root.index===t}return!1},h.prototype.reduce=function(t,e,r){return this.root&&(e=this.root.reduce(t,e,0,r,this)),e},h.prototype.reduceRight=function(t,e,r){return this.root&&(e=this.root.reduceRight(t,e,this.length-1,r,this)),e},h.prototype.min=function(t){var e=this.findLeast(t);if(e)return e.value},h.prototype.max=function(t){var e=this.findGreatest(t);if(e)return e.value},h.prototype.one=function(){return this.min()},h.prototype.clear=function(){var t;this.dispatchesRangeChanges&&(t=this.toArray(),this.dispatchBeforeRangeChange([],t,0)),this.root=null,this.length=0,this.dispatchesRangeChanges&&this.dispatchRangeChange([],t,0)},h.prototype.iterate=function(t,e){return new this.Iterator(this,t,e)},h.prototype.Iterator=u,h.prototype.summary=function(){return this.root?this.root.summary():"()"},h.prototype.log=function(t,e,r,n){t=t||a.unicodeRound,e=e||this.logNode,r||(r=console.log,n=console),r=r.bind(n),this.root&&this.root.log(t,e,r,r)},h.prototype.logNode=function(t,e,r){e(" "+t.value)},h.logCharsets=a,h.prototype.Node=c,c.prototype.reduce=function(t,e,r,n,i,o){if(o=o||0,this.left){var s=this.left.length;e=this.left.reduce(t,e,r,n,i,o+1),r+=s}return e=t.call(n,e,this.value,r,i,this,o),r+=1,this.right&&(e=this.right.reduce(t,e,r,n,i,o+1)),e},c.prototype.reduceRight=function(t,e,r,n,i,o){return o=o||0,this.right&&(e=this.right.reduceRight(t,e,r,n,i,o+1),r-=this.right.length),e=t.call(n,e,this.value,this.value,i,this,o),r-=1,this.left&&(e=this.left.reduceRight(t,e,r,n,i,o+1)),e},c.prototype.touch=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},c.prototype.checkIntegrity=function(){var t=1;if(t+=this.left?this.left.checkIntegrity():0,t+=this.right?this.right.checkIntegrity():0,this.length!==t)throw new Error("Integrity check failed: "+this.summary());return t},c.prototype.getNext=function(){var t=this;if(t.right){for(t=t.right;t.left;)t=t.left;return t}},c.prototype.getPrevious=function(){var t=this;if(t.left){for(t=t.left;t.right;)t=t.right;return t}},c.prototype.summary=function(){var t=this.value||"-";return t+=" <"+this.length,this.left||this.right?"("+t+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+t+")"},c.prototype.log=function(t,e,r,n){var i,o,s,a,h=this;i=this.left&&this.right?t.intersection:this.left?t.branchUp:this.right?t.branchDown:t.through,this.left&&this.left.log(t,e,(function(e){o?n(t.strafe+" "+e):(o=!0,n(t.fromBelow+t.through+e))}),(function(t){n("  "+t)})),e(this,(function(e){s?r((h.right?t.strafe:" ")+e):(s=!0,r(i+e))}),(function(e){n((h.left?t.strafe:" ")+e)})),this.right&&this.right.log(t,e,(function(e){a?r("  "+e):(a=!0,r(t.fromAbove+t.through+e))}),(function(e){r(t.strafe+" "+e)}))},u.prototype.__iterationObject=null,Object.defineProperty(u.prototype,"_iterationObject",{get:function(){return this.__iterationObject||(this.__iterationObject={done:!1,value:null})}}),u.prototype.next=function(){var t;return(t=this.prev?this.set.findLeastGreaterThan(this.prev.value):this.set.findLeast())?void 0!==this.end&&this.set.contentCompare(t.value,this.end)>=0?(this._iterationObject.done=!0,this._iterationObject.value=void 0):(this.prev=t,this._iterationObject.value=t.value):(this._iterationObject.done=!0,this._iterationObject.value=void 0),this._iterationObject}},312:t=>{"use strict";function e(){}t.exports=e,e.ascii={intersection:"+",through:"-",branchUp:"+",branchDown:"+",fromBelow:".",fromAbove:"'",fromBoth:"+",strafe:"|"},e.unicodeRound={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""},e.unicodeSharp={intersection:"",through:"",branchUp:"",branchDown:"",fromBelow:"",fromAbove:"",fromBoth:"",strafe:""}},114:(t,e,r)=>{t.exports="undefined"!=typeof WeakMap?WeakMap:r(277)},154:(t,e,r)=>{const n=r(864);t.exports=function(t){let e=1===t.length;t=t.toUpperCase();let r=n.filter((r=>r[e?"short":"long"]===t));return 0!==r.length?r[0].name:t}},288:(t,e,r)=>{"use strict";var n=r(154),i=/^A(\w{3})(\w{3,}?)(?:FLIGHT:(\d+)|\:(.+))?$/,o=/^HFDTE(?:DATE:)?(\d{2})(\d{2})(\d{2})(?:,?(\d{2}))?/,s=/^H(\w)PLT(?:.{0,}?:(.*)|(.*))$/,a=/^H(\w)CM2(?:.{0,}?:(.*)|(.*))$/,h=/^H(\w)GTY(?:.{0,}?:(.*)|(.*))$/,c=/^H(\w)GID(?:.{0,}?:(.*)|(.*))$/,u=/^H(\w)CID(?:.{0,}?:(.*)|(.*))$/,l=/^H(\w)CCL(?:.{0,}?:(.*)|(.*))$/,p=/^H(\w)SIT(?:.{0,}?:(.*)|(.*))$/,f=/^H(\w)FTY(?:.{0,}?:(.*)|(.*))$/,d=/^H(\w)RFW(?:.{0,}?:(.*)|(.*))$/,g=/^H(\w)RHW(?:.{0,}?:(.*)|(.*))$/,y=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{3})([NS])(\d{3})(\d{2})(\d{3})([EW])([AV])(-\d{4}|\d{5})(-\d{4}|\d{5})/,v=/^K(\d{2})(\d{2})(\d{2})/,m=/^[IJ](\d{2})(?:\d{2}\d{2}[A-Z]{3})+/,b=/^C(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{4})([-\d]{2})(.*)/,x=/^C(\d{2})(\d{2})(\d{3})([NS])(\d{3})(\d{2})(\d{3})([EW])(.*)/,w=["F","O","P"],_=function(){function t(t){void 0===t&&(t={}),this._result={numFlight:null,pilot:null,copilot:null,gliderType:null,registration:null,callsign:null,competitionClass:null,loggerType:null,firmwareVersion:null,hardwareVersion:null,task:null,fixes:[],dataRecords:[],security:null,errors:[]},this.fixExtensions=[],this.dataExtensions=[],this.lineNumber=0,this.prevTimestamp=null,this.options=t}return t.parse=function(e,r){void 0===r&&(r={});for(var n=new t(r),i=[],o=0,s=e.split("\n");o<s.length;o++){var a=s[o];try{n.processLine(a.trim())}catch(t){if(!r.lenient)throw t;i.push(t)}}var h=n.result;return h.errors=i,h},Object.defineProperty(t.prototype,"result",{get:function(){if(!this._result.loggerManufacturer)throw new Error("Missing A record");if(!this._result.date)throw new Error("Missing HFDTE record");return this._result},enumerable:!1,configurable:!0}),t.prototype.processLine=function(t){this.lineNumber+=1;var e=t[0];if("B"===e){var r=this.parseBRecord(t);this.prevTimestamp=r.timestamp,this._result.fixes.push(r)}else if("K"===e){var n=this.parseKRecord(t);this.prevTimestamp=n.timestamp,this._result.dataRecords.push(n)}else if("H"===e)this.processHeader(t);else if("C"===e)this.processTaskLine(t);else if("A"===e){var i=this.parseARecord(t);this._result.loggerId=i.loggerId,this._result.loggerManufacturer=i.manufacturer,null!==i.numFlight&&(this._result.numFlight=i.numFlight)}else"I"===e?this.fixExtensions=this.parseIJRecord(t):"J"===e?this.dataExtensions=this.parseIJRecord(t):"G"===e&&(this._result.security=(this._result.security||"")+t.slice(1))},t.prototype.processHeader=function(t){var e=t.slice(2,5);if("DTE"===e){var r=this.parseDateHeader(t);this._result.date=r.date,null!==r.numFlight&&(this._result.numFlight=r.numFlight)}else"PLT"===e?this._result.pilot=this.parsePilot(t):"CM2"===e?this._result.copilot=this.parseCopilot(t):"GTY"===e?this._result.gliderType=this.parseGliderType(t):"GID"===e?this._result.registration=this.parseRegistration(t):"CID"===e?this._result.callsign=this.parseCallsign(t):"CCL"===e?this._result.competitionClass=this.parseCompetitionClass(t):"SIT"===e?this._result.site=this.parseSite(t):"FTY"===e?this._result.loggerType=this.parseLoggerType(t):"RFW"===e?this._result.firmwareVersion=this.parseFirmwareVersion(t):"RHW"===e&&(this._result.hardwareVersion=this.parseHardwareVersion(t))},t.prototype.parseARecord=function(t){var e=t.match(i);if(e)return{manufacturer:n(e[1]),loggerId:e[2],numFlight:e[3]?parseInt(e[3],10):null,additionalData:e[4]||null};if(e=t.match(/^A(\w{3})(.+)?$/))return{manufacturer:n(e[1]),loggerId:null,numFlight:null,additionalData:e[2]?e[2].trim():null};throw new Error("Invalid A record at line "+this.lineNumber+": "+t)},t.prototype.parseDateHeader=function(t){var e=t.match(o);if(!e)throw new Error("Invalid DTE header at line "+this.lineNumber+": "+t);return{date:("8"===e[3][0]||"9"===e[3][0]?"19":"20")+e[3]+"-"+e[2]+"-"+e[1],numFlight:e[4]?parseInt(e[4],10):null}},t.prototype.parseTextHeader=function(t,e,r,n){void 0===n&&(n=" ");var i=r.match(e);if(!i)throw new Error("Invalid "+t+" header at line "+this.lineNumber+": "+r);var o=i[1];if(-1===w.indexOf(o)&&!this.options.lenient)throw new Error("Invalid data source at line "+this.lineNumber+": "+o);return(i[2]||i[3]||"").replace(/_/g,n).trim()},t.prototype.parsePilot=function(t){return this.parseTextHeader("PLT",s,t)},t.prototype.parseCopilot=function(t){return this.parseTextHeader("CM2",a,t)},t.prototype.parseGliderType=function(t){return this.parseTextHeader("GTY",h,t)},t.prototype.parseRegistration=function(t){return this.parseTextHeader("GID",c,t,"-")},t.prototype.parseCallsign=function(t){return this.parseTextHeader("GTY",u,t)},t.prototype.parseCompetitionClass=function(t){return this.parseTextHeader("GID",l,t)},t.prototype.parseSite=function(t){return this.parseTextHeader("SIT",p,t)},t.prototype.parseLoggerType=function(t){return this.parseTextHeader("FTY",f,t)},t.prototype.parseFirmwareVersion=function(t){return this.parseTextHeader("RFW",d,t)},t.prototype.parseHardwareVersion=function(t){return this.parseTextHeader("RHW",g,t)},t.prototype.processTaskLine=function(t){this._result.task?this._result.task.points.push(this.parseTaskPoint(t)):this._result.task=this.parseTask(t)},t.prototype.parseTask=function(t){var e=t.match(b);if(!e)throw new Error("Invalid task declaration at line "+this.lineNumber+": "+t);var r="8"===e[3][0]||"9"===e[3][0],n=(r?"19":"20")+e[3]+"-"+e[2]+"-"+e[1],i=e[4]+":"+e[5]+":"+e[6],o=Date.parse(n+"T"+i+"Z"),s=null;return"00"===e[7]&&"00"===e[8]&&"00"===e[9]||(s=((r="8"===e[9][0]||"9"===e[9][0])?"19":"20")+e[9]+"-"+e[8]+"-"+e[7]),{declarationDate:n,declarationTime:i,declarationTimestamp:o,flightDate:s,taskNumber:"0000"!==e[10]?parseInt(e[10],10):null,numTurnpoints:parseInt(e[11],10),comment:e[12]||null,points:[]}},t.prototype.parseTaskPoint=function(e){var r=e.match(x);if(!r)throw new Error("Invalid task point declaration at line "+this.lineNumber+": "+e);return{latitude:t.parseLatitude(r[1],r[2],r[3],r[4]),longitude:t.parseLongitude(r[5],r[6],r[7],r[8]),name:r[9]||null}},t.prototype.parseBRecord=function(e){if(!this._result.date)throw new Error("Missing HFDTE record before first B record");var r=e.match(y);if(!r)throw new Error("Invalid B record at line "+this.lineNumber+": "+e);var n=r[1]+":"+r[2]+":"+r[3],i=this.calcTimestamp(n),o=t.parseLatitude(r[4],r[5],r[6],r[7]),s=t.parseLongitude(r[8],r[9],r[10],r[11]),a="A"===r[12],h="00000"===r[13]?null:parseInt(r[13],10),c="00000"===r[14]?null:parseInt(r[14],10),u={};if(this.fixExtensions)for(var l=0,p=this.fixExtensions;l<p.length;l++){var f=p[l],d=f.code,g=f.start,v=f.length;u[d]=e.slice(g,g+v)}var m=null;if(u.ENL){var b=this.fixExtensions.filter((function(t){return"ENL"===t.code}))[0].length,x=Math.pow(10,b);m=parseInt(u.ENL,10)/x}return{timestamp:i,time:n,latitude:o,longitude:s,valid:a,pressureAltitude:h,gpsAltitude:c,extensions:u,enl:m,fixAccuracy:u.FXA?parseInt(u.FXA,10):null}},t.prototype.parseKRecord=function(t){if(!this._result.date)throw new Error("Missing HFDTE record before first K record");if(!this.dataExtensions)throw new Error("Missing J record before first K record");var e=t.match(v);if(!e)throw new Error("Invalid K record at line "+this.lineNumber+": "+t);var r=e[1]+":"+e[2]+":"+e[3],n=this.calcTimestamp(r),i={};if(this.dataExtensions)for(var o=0,s=this.dataExtensions;o<s.length;o++){var a=s[o],h=a.code,c=a.start,u=a.length;i[h]=t.slice(c,c+u)}return{timestamp:n,time:r,extensions:i}},t.prototype.parseIJRecord=function(t){var e=t.match(m);if(!e)throw new Error("Invalid "+t[0]+" record at line "+this.lineNumber+": "+t);var r=parseInt(e[1],10);if(t.length<3+7*r)throw new Error("Invalid "+t[0]+" record at line "+this.lineNumber+": "+t);for(var n=new Array(r),i=0;i<r;i++){var o=3+7*i,s=parseInt(t.slice(o,o+2),10)-1,a=parseInt(t.slice(o+2,o+4),10)-1-s+1,h=t.slice(o+4,o+7);n[i]={start:s,length:a,code:h}}return n},t.parseLatitude=function(t,e,r,n){var i=parseInt(t,10)+parseFloat(e+"."+r)/60;return"S"===n?-i:i},t.parseLongitude=function(t,e,r,n){var i=parseInt(t,10)+parseFloat(e+"."+r)/60;return"W"===n?-i:i},t.prototype.calcTimestamp=function(t){for(var e=Date.parse(this._result.date+"T"+t+"Z");this.prevTimestamp&&e<this.prevTimestamp-36e5;)e+=864e5;return e},t}();t.exports=_},402:function(t){t.exports=function(){"use strict";function t(t,n,i,o,s){!function t(r,n,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,h=n-i+1,c=Math.log(a),u=.5*Math.exp(2*c/3),l=.5*Math.sqrt(c*u*(a-u)/a)*(h-a/2<0?-1:1);t(r,n,Math.max(i,Math.floor(n-h*u/a+l)),Math.min(o,Math.floor(n+(a-h)*u/a+l)),s)}var p=r[n],f=i,d=o;for(e(r,i,n),s(r[o],p)>0&&e(r,i,o);f<d;){for(e(r,f,d),f++,d--;s(r[f],p)<0;)f++;for(;s(r[d],p)>0;)d--}0===s(r[i],p)?e(r,i,d):e(r,++d,o),d<=n&&(i=d+1),n<=d&&(o=d-1)}}(t,n,i||0,o||t.length-1,s||r)}function e(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function r(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,n,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<r;o++){var s=t.children[o];a(i,t.leaf?n(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,r,n,i,o){for(var s=[r,n];s.length;)if(!((n=s.pop())-(r=s.pop())<=i)){var a=r+Math.ceil((n-r)/i/2)*i;t(e,a,r,n,o),s.push(r,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,r=[];if(!f(t,e))return r;for(var n=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?n(s):s;f(t,a)&&(e.leaf?r.push(s):p(t,a)?this._all(s,r):i.push(s))}e=i.pop()}return r},n.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var r=[];e;){for(var n=0;n<e.children.length;n++){var i=e.children[n],o=e.leaf?this.toBBox(i):i;if(f(t,o)){if(e.leaf||p(t,o))return!0;r.push(i)}}e=r.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=d([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var r,n,o,s=this.data,a=this.toBBox(t),h=[],c=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],r=c.pop(),o=!0),s.leaf){var u=i(t,s.children,e);if(-1!==u)return s.children.splice(u,1),h.push(s),this._condense(h),this}o||s.leaf||!p(s,a)?n?(r++,s=n.children[r],o=!1):s=null:(h.push(s),c.push(r),r=0,n=s,s=s.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},n.prototype._build=function(t,e,r,n){var i,s=r-e+1,a=this._maxEntries;if(s<=a)return o(i=d(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),(i=d([])).leaf=!1,i.height=n;var h=Math.ceil(s/a),c=h*Math.ceil(Math.sqrt(a));g(t,e,r,c,this.compareMinX);for(var u=e;u<=r;u+=c){var l=Math.min(u+c-1,r);g(t,u,l,h,this.compareMinY);for(var p=u;p<=l;p+=h){var f=Math.min(p+h-1,l);i.children.push(this._build(t,p,f,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(t,e,r,n){for(;n.push(e),!e.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var h=e.children[a],c=u(h),l=(p=t,f=h,(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-c);l<o?(o=l,i=c<i?c:i,s=h):l===o&&c<i&&(i=c,s=h)}e=s||e.children[0]}var p,f;return e},n.prototype._insert=function(t,e,r){var n=r?t:this.toBBox(t),i=[],o=this._chooseSubtree(n,this.data,e,i);for(o.children.push(t),a(o,n);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(n,i,e)},n.prototype._split=function(t,e){var r=t[e],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var s=this._chooseSplitIndex(r,i,n),a=d(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(r,a)},n.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,r){for(var n,i,o,a,h,c,l,p=1/0,f=1/0,d=e;d<=r-e;d++){var g=s(t,0,d,this.toBBox),y=s(t,d,r,this.toBBox),v=(i=g,o=y,void 0,void 0,void 0,void 0,a=Math.max(i.minX,o.minX),h=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),l=Math.min(i.maxY,o.maxY),Math.max(0,c-a)*Math.max(0,l-h)),m=u(g)+u(y);v<p?(p=v,n=d,f=m<f?m:f):v===p&&m<f&&(f=m,n=d)}return n||r-e},n.prototype._chooseSplitAxis=function(t,e,r){var n=t.leaf?this.compareMinX:h,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,r,n){t.children.sort(n);for(var i=this.toBBox,o=s(t,0,e,i),h=s(t,r-e,r,i),c=l(o)+l(h),u=e;u<r-e;u++){var p=t.children[u];a(o,t.leaf?i(p):p),c+=l(o)}for(var f=r-e-1;f>=e;f--){var d=t.children[f];a(h,t.leaf?i(d):d),c+=l(h)}return c},n.prototype._adjustParentBBoxes=function(t,e,r){for(var n=r;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},n}()},277:t=>{!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=y);var e=!1;if("function"==typeof WeakMap){var r=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var n=new r,i=Object.freeze({});if(n.set(i,1),1===n.get(i))return void(t.exports=WeakMap);e=!0}}Object.prototype.hasOwnProperty;var o=Object.getOwnPropertyNames,s=Object.defineProperty,a=Object.isExtensible,h="weakmap:",c=h+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var u=new ArrayBuffer(25),l=new Uint8Array(u);crypto.getRandomValues(l),c=h+"rand:"+Array.prototype.map.call(l,(function(t){return(t%36).toString(36)})).join("")+"___"}if(s(Object,"getOwnPropertyNames",{value:function(t){return o(t).filter(v)}}),"getPropertyNames"in Object){var p=Object.getPropertyNames;s(Object,"getPropertyNames",{value:function(t){return p(t).filter(v)}})}!function(){var t=Object.freeze;s(Object,"freeze",{value:function(e){return m(e),t(e)}});var e=Object.seal;s(Object,"seal",{value:function(t){return m(t),e(t)}});var r=Object.preventExtensions;s(Object,"preventExtensions",{value:function(t){return m(t),r(t)}})}();var f=!1,d=0,g=function(){this instanceof g||x();var t=[],e=[],r=d++;return Object.create(g.prototype,{get___:{value:b((function(n,i){var o,s=m(n);return s?r in s?s[r]:i:(o=t.indexOf(n))>=0?e[o]:i}))},has___:{value:b((function(e){var n=m(e);return n?r in n:t.indexOf(e)>=0}))},set___:{value:b((function(n,i){var o,s=m(n);return s?s[r]=i:(o=t.indexOf(n))>=0?e[o]=i:(o=t.length,e[o]=i,t[o]=n),this}))},delete___:{value:b((function(n){var i,o,s=m(n);return s?r in s&&delete s[r]:!((i=t.indexOf(n))<0||(o=t.length-1,t[i]=void 0,e[i]=e[o],t[i]=t[o],t.length=o,e.length=o,0))}))}})};g.prototype=Object.create(Object.prototype,{get:{value:function(t,e){return this.get___(t,e)},writable:!0,configurable:!0},has:{value:function(t){return this.has___(t)},writable:!0,configurable:!0},set:{value:function(t,e){return this.set___(t,e)},writable:!0,configurable:!0},delete:{value:function(t){return this.delete___(t)},writable:!0,configurable:!0}}),"function"==typeof r?function(){function n(){this instanceof g||x();var t,n=new r,i=void 0,o=!1;return t=e?function(t,e){return n.set(t,e),n.has(t)||(i||(i=new g),i.set(t,e)),this}:function(t,e){if(o)try{n.set(t,e)}catch(r){i||(i=new g),i.set___(t,e)}else n.set(t,e);return this},Object.create(g.prototype,{get___:{value:b((function(t,e){return i?n.has(t)?n.get(t):i.get___(t,e):n.get(t,e)}))},has___:{value:b((function(t){return n.has(t)||!!i&&i.has___(t)}))},set___:{value:b(t)},delete___:{value:b((function(t){var e=!!n.delete(t);return i&&i.delete___(t)||e}))},permitHostObjects___:{value:b((function(t){if(t!==y)throw new Error("bogus call to permitHostObjects___");o=!0}))}})}e&&"undefined"!=typeof Proxy&&(Proxy=void 0),n.prototype=g.prototype,t.exports=n,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),t.exports=g)}function y(t){t.permitHostObjects___&&t.permitHostObjects___(y)}function v(t){return!(t.substr(0,h.length)==h&&"___"===t.substr(t.length-3))}function m(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var e=t[c];if(e&&e.key===t)return e;if(a(t)){e={key:t};try{return s(t,c,{value:e,writable:!1,enumerable:!1,configurable:!1}),e}catch(t){return}}}function b(t){return t.prototype=null,Object.freeze(t)}function x(){f||"undefined"==typeof console||(f=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},864:t=>{"use strict";t.exports=JSON.parse('[{"name":"Aircotec","long":"ACT","short":"I"},{"name":"Cambridge Aero Instruments","long":"CAM","short":"C"},{"name":"ClearNav Instruments","long":"CNI","short":null},{"name":"Data Swan/DSX","long":"DSX","short":"D"},{"name":"EW Avionics","long":"EWA","short":"E"},{"name":"Filser","long":"FIL","short":"F"},{"name":"Flarm","long":"FLA","short":"G"},{"name":"Flytech","long":"FLY","short":null},{"name":"Garrecht","long":"GCS","short":"A"},{"name":"IMI Gliding Equipment","long":"IMI","short":"M"},{"name":"Logstream","long":"LGS","short":null},{"name":"LX Navigation","long":"LXN","short":"L"},{"name":"LXNAV","long":"LXV","short":"V"},{"name":"Naviter","long":"NAV","short":null},{"name":"New Technologies","long":"NTE","short":"N"},{"name":"Nielsen Kellerman","long":"NKL","short":"K"},{"name":"Peschges","long":"PES","short":"P"},{"name":"PressFinish Electronics","long":"PFE","short":null},{"name":"Print Technik","long":"PRT","short":"R"},{"name":"Scheffel","long":"SCH","short":"H"},{"name":"Streamline Data Instruments","long":"SDI","short":"S"},{"name":"Triadis Engineering GmbH","long":"TRI","short":"T"},{"name":"Zander","long":"ZAN","short":"Z"},{"name":"XCSoar","long":"XCS","short":null},{"name":"LK8000","long":"XLK","short":null},{"name":"GpsDump","long":"XGD","short":null},{"name":"SeeYou Recorder","long":"XCM","short":null},{"name":"Flyskyhy","long":"XFH","short":null},{"name":"XCTrack","long":"XCT","short":null},{"name":"Flymaster Live","long":"XFM","short":null},{"name":"XCTracer","long":"XTR","short":null},{"name":"SkyBean","long":"XSB","short":null},{"name":"leGPSBip","long":"XSD","short":null},{"name":"Logfly","long":"XLF","short":null},{"name":"Loctome","long":"XLM","short":null}]')}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{score:()=>K,xcScoringRules:()=>J});var t=r(288),e=r.n(t),i=r(50);const o={a:6378.137,b:6356.752314245,f:1/298.257223563};function s(t){return t/(180/Math.PI)}function a(t){return t*(180/Math.PI)}class h{constructor(t,e){Array.isArray(t)?(this.x=+t[e].longitude,this.y=+t[e].latitude,this.r=+e):(this.x=t,this.y=e)}geojson(t,e){return{type:"Feature",id:t,properties:e||{},geometry:{type:"Point",coordinates:[this.x,this.y]}}}toString(){return JSON.stringify(this.geojson())}intersects(t){if(t instanceof h)return this.x==t.x&&this.y==t.y;if(t instanceof u)return t.intersects(this);throw new TypeError("other must be either Point or Box")}distanceEarth(t){return this.distanceEarthFCC(t)}distanceEarthFCC(t){const e=t.y-this.y,r=t.x-this.x,n=s((this.y+t.y)/2),i=Math.cos(n),o=2*i*i-1,a=i*(2*o-1),h=111.13209-.566605*o+.0012*(2*o*o-1),c=111.41513*i-.09455*a+12e-5*(2*o*a-i);return Math.sqrt(h*e*(h*e)+c*r*(c*r))}distanceEarthRev(t,e){const r=this.x+a(t/6371/Math.cos(s(this.y))),n=this.y+a(e/6371);return new h(r,n)}distanceEarthVincentys(t){return function(t,e){const r=s(t.y),n=s(t.x),i=s(e.y),h=s(e.x),{a:c,b:u,f:l}=o,p=h-n,f=(1-l)*Math.tan(r),d=1/Math.sqrt(1+f*f),g=f*d,y=(1-l)*Math.tan(i),v=1/Math.sqrt(1+y*y),m=y*v,b=g*m,x=d*v,w=d*m,_=g*v,O=Math.abs(p)>Math.PI/2||Math.abs(i-r)>Math.PI/2;let C=p,j=null,E=null,M=O?Math.PI:0,A=0,P=O?-1:1,D=null,k=1,L=null,S=1,F=null,T=null,I=0;do{j=Math.sin(C),E=Math.cos(C);const t=v*j,e=w-_*E;if(D=t*t+e*e,Math.abs(D)<Number.EPSILON)break;if(A=Math.sqrt(D),P=b+x*E,M=Math.atan2(A,P),L=x*j/A,S=1-L*L,k=0!=S?P-2*b/S:0,F=l/16*S*(4+l*(4-3*S)),T=C,C=p+(1-F)*l*L*(M+F*A*(k+F*P*(2*k*k-1))),(O?Math.abs(C)-Math.PI:Math.abs(C))>Math.PI)throw new EvalError(" > ")}while(Math.abs(C-T)>1e-7&&++I<1e3);if(I>=1e3)throw new EvalError("Vincenty formula failed to converge");const R=S*(c*c-u*u)/(u*u),N=R/1024*(256+R*(R*(74-47*R)-128)),B=u*(1+R/16384*(4096+R*(R*(320-175*R)-768)))*(M-N*A*(k+N/4*(P*(2*k*k-1)-N/6*k*(4*A*A-3)*(4*k*k-3)))),X=Math.abs(D)<Number.EPSILON?0:Math.atan2(v*j,w-_*E),q=Math.abs(D)<Number.EPSILON?Math.PI:Math.atan2(d*j,w*E-_);return{distance:B,initialBearing:Math.abs(B)<Number.EPSILON?NaN:a(X),finalBearing:Math.abs(B)<Number.EPSILON?NaN:a(q),iterations:I}}(this,t).distance}}class c{constructor(t,e){if(this.start=t,this.end=e,e<t)throw new Error("start should be before end")}count(){return this.end-this.start+1}center(){return this.start+Math.floor((this.end-this.start)/2)}left(){return new c(this.start,this.center())}right(){return new c(this.start+Math.ceil((this.end-this.start)/2),this.end)}contains(t){return this.start<=t&&t<=this.end}toString(){return`${this.start}:${this.end}`}}class u{constructor(t,e,r,n){if(t instanceof c){this.x1=1/0,this.y1=1/0,this.x2=-1/0,this.y2=-1/0;for(let r=t.start;r<=t.end;r++)this.x1=Math.min(e.flightPoints[r].x,this.x1),this.y1=Math.min(e.flightPoints[r].y,this.y1),this.x2=Math.max(e.flightPoints[r].x,this.x2),this.y2=Math.max(e.flightPoints[r].y,this.y2)}else this.x1=t,this.y1=e,this.x2=r,this.y2=n}vertices(){return[new h(this.x1,this.y1),new h(this.x2,this.y1),new h(this.x2,this.y2),new h(this.x1,this.y2)]}intersects(t){return t instanceof h?this.x1<=t.x&&this.y1<=t.y&&this.x2>=t.x&&this.y2>=t.y:!(this.x1>t.x2||this.x2<t.x1||this.y1>t.y2||this.y2<t.y1)}area(){return Math.abs((this.x2-this.x1)*(this.y2-this.y1))}distance(t){if(this.intersects(t))return 0;let e=this.x1,r=this.x1,n=this.y1,i=this.y1;return this.x1>t.x2?r=t.x2:this.x2<t.x1&&(e=this.x2,r=t.x1),this.y1<t.y2?i=t.y2:this.y2>t.y1&&(n=this.y2,i=t.y1),new h(e,n).distanceEarth(new h(r,i))}geojson(t,e){return{type:"Feature",id:t,properties:e||{},geometry:{type:"Polygon",coordinates:[[[this.x1,this.y1],[this.x1,this.y2],[this.x2,this.y2],[this.x2,this.y1],[this.x1,this.y1]]]}}}geojson_collection(t){let e=[];for(let r=0;r<t.length;r++)e.push(t[r].geojson(r,{id:r}));return{type:"FeatureCollection",features:e}}toString(){return JSON.stringify(this.geojson())}}let l=0;class p{constructor(t,e,r){t.length>e.scoring.cardinality?this.ranges=t.slice(0,e.scoring.cardinality):this.ranges=t,this.opt=e,this.boxes=[];for(let t=0;t<this.ranges.length;t++)t>0&&this.ranges[t-1].start>this.ranges[t].start&&(this.ranges[t]=new c(this.ranges[t-1].start,this.ranges[t].end)),t<this.ranges.length-1&&this.ranges[t].end>this.ranges[t+1].end&&(this.ranges[t]=new c(this.ranges[t].start,this.ranges[t+1].end)),this.boxes[t]=new u(this.ranges[t],e.flight);this.score=void 0,this.bound=void 0,this.id=l++,this.opt.config&&this.opt.config.debug&&(this.parent=r,this.trace("constructor"))}do_branch(){let t=0;for(let e=0;e<this.ranges.length;e++)this.ranges[e].count()>this.ranges[t].count()&&(t=e);for(let e=0;e<this.ranges.length;e++)this.ranges[e].count()>1&&this.boxes[e].area()>8*this.boxes[t].area()&&(t=e);if(1==this.ranges[t].count())return[];let e=[];for(let r of[this.ranges[t].left(),this.ranges[t].right()]){let n=[];for(let e=0;e<this.ranges.length;e++)n[e]=e!=t?this.ranges[e]:r;e.push(new p(n,this.opt,this))}return e}do_bound(){this.bound=this.opt.scoring.bound(this.ranges,this.boxes,this.opt),this.trace("bounding")}do_score(){for(let t=0;t<this.ranges.length;t++)if(t<this.ranges.length-1&&this.ranges[t].center()>=this.ranges[t+1].center())return void(this.score=0);let t=[];for(let e=0;e<this.ranges.length;e++)t[e]=new h(this.opt.flight.filtered,this.ranges[e].center());this.scoreInfo=this.opt.scoring.score(t,this.opt),this.opt.scoring.post&&this.opt.scoring.post(this.scoreInfo,this.opt),this.score=this.scoreInfo.score,this.trace("scoring")}contentEquals(t,e){return t.id===e.id}contentCompare(t,e){return t.bound<e.bound?-1:t.bound>e.bound?1:t.id<e.id?-1:t.id>e.id?1:0}geojson(){let t=[];if(this.opt.config&&this.opt.config.debug)for(let e=0;e<this.ranges.length;e++)t.push(new u(this.ranges[e],this.opt.flight).geojson("box"+e,{id:"box"+e,area:new u(this.ranges[e],this.opt.flight).area(),a:this.ranges[e].start,b:this.ranges[e].end}));try{const e=this.scoreInfo.tp;for(const r in e)t.push(e[r].geojson("tp"+r,{id:"tp"+r,r:e[r].r,timestamp:void 0!==e[r].r?this.opt.flight.filtered[e[r].r].timestamp:void 0})),this.scoreInfo.ep&&r==e.length-1||t.push({type:"Feature",id:"seg"+r,properties:{id:"seg"+r,stroke:"yellow","stroke-width":4,d:e[r].distanceEarth(e[(r+1)%e.length])},geometry:{type:"LineString",coordinates:[[e[r].x,e[r].y],[e[(r+1)%e.length].x,e[(r+1)%e.length].y]],style:{stroke:"yellow","stroke-width":4}}});if(this.opt.config.debug&&this.boxes)for(const e in this.boxes)t.push({type:"Feature",id:"box"+e,properties:{id:"box"+e,stroke:"black","stroke-width":4},geometry:{type:"LineString",coordinates:[[this.boxes[e].x1,this.boxes[e].y1],[this.boxes[e].x2,this.boxes[e].y1],[this.boxes[e].x2,this.boxes[e].y2],[this.boxes[e].x1,this.boxes[e].y2],[this.boxes[e].x1,this.boxes[e].y1]],style:{stroke:"black","stroke-width":4}}})}catch(t){}try{if(void 0!==this.scoreInfo.ep||void 0!==this.scoreInfo.cp){const e=this.scoreInfo.cp,r=this.scoreInfo.tp,n=this.scoreInfo.ep;if(e&&e.in&&e.out){for(let r of["in","out"])t.push(e[r].geojson("cp_"+r,{id:"cp_"+r,r:e[r].r,timestamp:this.opt.flight.filtered[e[r].r].timestamp}));t.push({type:"Feature",id:"closing",properties:{id:"closing",stroke:"green","stroke-width":3,d:e.in.distanceEarth(e.out)},geometry:{type:"LineString",coordinates:[[e.in.x,e.in.y],[e.out.x,e.out.y]],style:{stroke:"green","stroke-width":3}}})}if(n&&n.start&&n.finish){for(let e of["start","finish"])t.push(n[e].geojson("ep_"+e,{id:"ep_"+e,r:n[e].r,timestamp:this.opt.flight.filtered[n[e].r].timestamp}));t.push({type:"Feature",id:"seg_in",properties:{id:"seg_in",stroke:"gold","stroke-width":3,d:n.start.distanceEarth(r[0])},geometry:{type:"LineString",coordinates:[[n.start.x,n.start.y],[r[0].x,r[0].y]],style:{stroke:"green","stroke-width":3}}}),t.push({type:"Feature",id:"seg_out",properties:{id:"seg_out",stroke:"gold","stroke-width":3,d:n.finish.distanceEarth(r[2])},geometry:{type:"LineString",coordinates:[[r[2].x,r[2].y],[n.finish.x,n.finish.y]],style:{stroke:"green","stroke-width":3}}})}}}catch(t){}for(let e=0;e<this.opt.flight.ll.length;e++){const r=this.opt.flight.ll[e];t.push(this.opt.flight.flightPoints[r.launch].geojson("launch"+e,{id:"launch"+e,r:r.launch,timestamp:this.opt.flight.filtered[r.launch].timestamp})),t.push(this.opt.flight.flightPoints[r.landing].geojson("land"+e,{id:"land"+e,r:r.landing,timestamp:this.opt.flight.filtered[r.landing].timestamp}))}if(!this.opt.config||!this.opt.config.noflight){let e=[];for(let t of this.opt.flight.filtered)e.push([t.longitude,t.latitude]);t.push({type:"Feature",id:"flight",properties:{id:"flight"},geometry:{type:"LineString",coordinates:e}})}return{type:"FeatureCollection",properties:{name:"EPSG:3857",id:this.id,score:void 0!==this.score?this.score:void 0,bound:void 0!==this.currentUpperBound?this.currentUpperBound:this.bound,optimal:this.optimal,processedTime:this.time/1e3,processedSolutions:this.processed,type:this.opt.scoring.name,code:this.opt.scoring.code},features:t}}toString(){let t=`${this.opt.scoring.name}`;if(this.score&&(t+=` ${this.score} points`),this.scoreInfo&&(t+=` ${this.scoreInfo.distance.toFixed(2)}km`),t+=` ( <${this.bound.toFixed(2)} )`,this.opt.config&&this.opt.config.debug){t+=` { id: ${this.id} `;for(let e of this.ranges)t+=" "+e.toString();t+=" } "}return t}trace(t){if(!this.opt.config.trace||!process.stdout)return;const e=this.opt.config.trace.split(",").map((t=>parseInt(t,10)));if(e[0]<0){if(this.id%e[1]!=0)return}else if(this.ranges.some(((t,r)=>!t.contains(e[r]))))return;let r=`${t||""} solution tracing: ${this.id} ${this.opt.scoring.name} `;for(const t of this.ranges)r+=t+" ";this.bound&&(r+=`bound: ${this.bound} `),this.score&&(r+=`score: ${this.score} `),process.stdout.write("\n"+r+"\n"),this.opt.config.env.fs.writeFileSync(`debug-${this.id}.json`,JSON.stringify(this.geojson({debug:!0})))}}class f{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,e){let r=this.length++;for(;r>0;){const t=r-1>>1,n=this.values[t];if(e>=n)break;this.ids[r]=this.ids[t],this.values[r]=n,r=t}this.ids[r]=t,this.values[r]=e}pop(){if(0===this.length)return;const t=this.ids[0];if(this.length--,this.length>0){const t=this.ids[0]=this.ids[this.length],e=this.values[0]=this.values[this.length],r=this.length>>1;let n=0;for(;n<r;){let t=1+(n<<1);const r=t+1;let i=this.ids[t],o=this.values[t];const s=this.values[r];if(r<this.length&&s<o&&(t=r,i=this.ids[r],o=s),o>=e)break;this.ids[n]=i,this.values[n]=o,n=t}this.ids[n]=t,this.values[n]=e}return t}peek(){if(0!==this.length)return this.ids[0]}peekValue(){if(0!==this.length)return this.values[0]}shrink(){this.ids.length=this.values.length=this.length}}const d=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class g{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,r]=new Uint8Array(t,0,2);if(251!==e)throw new Error("Data does not appear to be in a Flatbush format.");if(r>>4!=3)throw new Error(`Got v${r>>4} data when expected v3.`);const[n]=new Uint16Array(t,2,1),[i]=new Uint32Array(t,4,1);return new g(i,n,d[15&r],t)}constructor(t,e=16,r=Float64Array,n){if(void 0===t)throw new Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535);let i=t,o=i;this._levelBounds=[4*i];do{i=Math.ceil(i/this.nodeSize),o+=i,this._levelBounds.push(4*o)}while(1!==i);this.ArrayType=r||Float64Array,this.IndexArrayType=o<16384?Uint16Array:Uint32Array;const s=d.indexOf(this.ArrayType),a=4*o*this.ArrayType.BYTES_PER_ELEMENT;if(s<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this._boxes=new this.ArrayType(this.data,8,4*o),this._indices=new this.IndexArrayType(this.data,8+a,o),this._pos=4*o,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1]):(this.data=new ArrayBuffer(8+a+o*this.IndexArrayType.BYTES_PER_ELEMENT),this._boxes=new this.ArrayType(this.data,8,4*o),this._indices=new this.IndexArrayType(this.data,8+a,o),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(this.data,0,2).set([251,48+s]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t),this._queue=new f}add(t,e,r,n){const i=this._pos>>2;return this._indices[i]=i,this._boxes[this._pos++]=t,this._boxes[this._pos++]=e,this._boxes[this._pos++]=r,this._boxes[this._pos++]=n,t<this.minX&&(this.minX=t),e<this.minY&&(this.minY=e),r>this.maxX&&(this.maxX=r),n>this.maxY&&(this.maxY=n),i}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);if(this.numItems<=this.nodeSize)return this._boxes[this._pos++]=this.minX,this._boxes[this._pos++]=this.minY,this._boxes[this._pos++]=this.maxX,void(this._boxes[this._pos++]=this.maxY);const t=this.maxX-this.minX||1,e=this.maxY-this.minY||1,r=new Uint32Array(this.numItems);for(let n=0;n<this.numItems;n++){let i=4*n;const o=this._boxes[i++],s=this._boxes[i++],a=this._boxes[i++],h=this._boxes[i++],c=Math.floor(65535*((o+a)/2-this.minX)/t),u=Math.floor(65535*((s+h)/2-this.minY)/e);r[n]=x(c,u)}m(r,this._boxes,this._indices,0,this.numItems-1,this.nodeSize);for(let t=0,e=0;t<this._levelBounds.length-1;t++){const r=this._levelBounds[t];for(;e<r;){const t=e;let n=1/0,i=1/0,o=-1/0,s=-1/0;for(let t=0;t<this.nodeSize&&e<r;t++)n=Math.min(n,this._boxes[e++]),i=Math.min(i,this._boxes[e++]),o=Math.max(o,this._boxes[e++]),s=Math.max(s,this._boxes[e++]);this._indices[this._pos>>2]=t,this._boxes[this._pos++]=n,this._boxes[this._pos++]=i,this._boxes[this._pos++]=o,this._boxes[this._pos++]=s}}}search(t,e,r,n,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const s=[],a=[];for(;void 0!==o;){const h=Math.min(o+4*this.nodeSize,v(o,this._levelBounds));for(let c=o;c<h;c+=4){if(r<this._boxes[c])continue;if(n<this._boxes[c+1])continue;if(t>this._boxes[c+2])continue;if(e>this._boxes[c+3])continue;const h=0|this._indices[c>>2];o<4*this.numItems?(void 0===i||i(h))&&a.push(h):s.push(h)}o=s.pop()}return a}neighbors(t,e,r=1/0,n=1/0,i){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const s=this._queue,a=[],h=n*n;for(;void 0!==o;){const n=Math.min(o+4*this.nodeSize,v(o,this._levelBounds));for(let r=o;r<n;r+=4){const n=0|this._indices[r>>2],a=y(t,this._boxes[r],this._boxes[r+2]),h=y(e,this._boxes[r+1],this._boxes[r+3]),c=a*a+h*h;o<4*this.numItems?(void 0===i||i(n))&&s.push(1+(n<<1),c):s.push(n<<1,c)}for(;s.length&&1&s.peek();){if(s.peekValue()>h)return s.clear(),a;if(a.push(s.pop()>>1),a.length===r)return s.clear(),a}o=s.pop()>>1}return s.clear(),a}}function y(t,e,r){return t<e?e-t:t<=r?0:t-r}function v(t,e){let r=0,n=e.length-1;for(;r<n;){const i=r+n>>1;e[i]>t?n=i:r=i+1}return e[r]}function m(t,e,r,n,i,o){if(Math.floor(n/o)>=Math.floor(i/o))return;const s=t[n+i>>1];let a=n-1,h=i+1;for(;;){do{a++}while(t[a]<s);do{h--}while(t[h]>s);if(a>=h)break;b(t,e,r,a,h)}m(t,e,r,n,h,o),m(t,e,r,h+1,i,o)}function b(t,e,r,n,i){const o=t[n];t[n]=t[i],t[i]=o;const s=4*n,a=4*i,h=e[s],c=e[s+1],u=e[s+2],l=e[s+3];e[s]=e[a],e[s+1]=e[a+1],e[s+2]=e[a+2],e[s+3]=e[a+3],e[a]=h,e[a+1]=c,e[a+2]=u,e[a+3]=l;const p=r[n];r[n]=r[i],r[i]=p}function x(t,e){let r=t^e,n=65535^r,i=65535^(t|e),o=t&(65535^e),s=r|n>>1,a=r>>1^r,h=i>>1^n&o>>1^i,c=r&i>>1^o>>1^o;r=s,n=a,i=h,o=c,s=r&r>>2^n&n>>2,a=r&n>>2^n&(r^n)>>2,h^=r&i>>2^n&o>>2,c^=n&i>>2^(r^n)&o>>2,r=s,n=a,i=h,o=c,s=r&r>>4^n&n>>4,a=r&n>>4^n&(r^n)>>4,h^=r&i>>4^n&o>>4,c^=n&i>>4^(r^n)&o>>4,r=s,n=a,i=h,o=c,h^=r&i>>8^n&o>>8,c^=n&i>>8^(r^n)&o>>8,r=h^h>>1,n=c^c>>1;let u=t^e,l=n|65535^(u|r);return u=16711935&(u|u<<8),u=252645135&(u|u<<4),u=858993459&(u|u<<2),u=1431655765&(u|u<<1),l=16711935&(l|l<<8),l=252645135&(l|l<<4),l=858993459&(l|l<<2),l=1431655765&(l|l<<1),(l<<1|u)>>>0}var w=r(466),_=r(402);function O(t){const e=t[0].vertices(),r=t[1].vertices();let n=1/0;for(let t of e)for(let e of r){const r=t.distanceEarth(e);n=Math.min(n,r)}return n}function C(t){const e=t[0].vertices(),r=t[1].vertices();let n=0;for(let t of e)for(let e of r){const r=t.distanceEarth(e);n=Math.max(n,r)}return n}function j(t,e,r){let n=0;for(let i of e[r]){const o=void 0!==t?i.distanceEarth(t):0,s=e.length>r+1?j(i,e,r+1):0;n=Math.max(n,o+s)}return n}function E(t){let e=[],r=1/0,n=1/0,i=-1/0,o=-1/0,s=[];for(let a=0;a<t.length;a++){if(t[a]instanceof u)e[a]=t[a].vertices(),r=Math.min(r,t[a].x1),n=Math.min(n,t[a].y1),i=Math.max(i,t[a].x2),o=Math.max(o,t[a].y2);else{if(!(t[a]instanceof h))throw new TypeError("boxes must contain only Box or Point");e[a]=[t[a]],r=Math.min(r,t[a].x),n=Math.min(n,t[a].y),i=Math.max(i,t[a].x),o=Math.max(o,t[a].y)}s[a]=[]}for(let e=1;e<t.length;e++)t[e-1].intersects(t[e])&&(t[e-1].intersecting=!0,t[e].intersecting=!0);for(let a=0;a<t.length;a++)if(t[a].intersecting)s[a]=e[a];else{for(let t of e[a])t.x!=r&&t.x!=i||t.y!=n&&t.y!=o||s[a].push(t);if(0==s[a].length)for(let t of e[a])t.x!=r&&t.x!=i&&t.y!=n&&t.y!=o||s[a].push(t);0==s[a].length&&(s[a]=e[a])}return j(void 0,s,0)}function M(t,e,r,n){let i,o,s;if(r instanceof u)i=r.vertices();else{if(!(r instanceof h))throw new TypeError("target must be either Point or Box");i=[r]}if(t===n.launch)o=0,s=+e;else{if(e!==n.landing)throw new RangeError("this function supports seeking only from the launch or the landing point");o=1,s=+t}let a,c=-1/0;for(let h of i){let l,p,f=-1/0;const d=n.flight.furthestPoints[o].get(h.x+":"+h.y);for(const t of d||[])if(s>=t.min&&s<=t.max){p=t;break}if(p){if(!(t<=p.o.r&&p.o.r<=e))throw new Error("furthestPoints cache inconsistency");f=h.distanceEarth(p.o),l=p.o}if(void 0===l){let s=!1,a=!1;for(let i=t;i<=e;i++){const t=n.flight.flightPoints[i];if(r instanceof u&&r.intersects(t)){s=!0;continue}const e=h.distanceEarth(t);e>f&&(f=e,l=t,a=!0)}if(s)for(let t of i){const e=h.distanceEarth(t);e>f&&(f=e,l=r,a=!1)}if(a){let r;t===n.launch?r={min:+l.r,max:+e}:e===n.landing&&(r={min:+t,max:+l.r});let i=d;i||(i=[],n.flight.furthestPoints[o].set(h.x+":"+h.y,i));const s=i.filter((t=>t.o.r==l.r&&!(r.max<=t.min||r.min>=t.max)))[0];s?(s.min=Math.min(r.min,s.min),s.max=Math.max(r.max,s.max)):i.push({...r,o:l})}}f>c&&(c=f,a=l)}return void 0===a&&(a=r),a}function A(t,e,r,n){const i=n.flight.closestPairs.search({minX:n.launch,minY:e,maxX:t,maxY:n.landing});for(let t of i)if(t.o.d<=n.scoring.closingDistanceFree)return t.o;const o=function(t,e,r){let n=r.flight.closestPairs.search({minX:t,minY:e,maxX:t,maxY:e}),i=n.reduce(((t,e)=>!t||e.in>t.in?e:t),void 0);if(i=n.reduce(((t,e)=>!t||e.out<t.out?e:t),i),void 0!==i)return i.o;const o=new g(t+1-r.launch,8),a=Math.abs(Math.cos(s(r.flight.flightPoints[t].y)));for(let e=r.launch;e<=t;e++){const t=r.flight.flightPoints[e];o.add(t.x*a,t.y,t.x*a,t.y)}o.finish(),n=r.flight.closestPairs.search({minX:t,minY:e,maxX:t,maxY:r.landing});const h=n.reduce(((t,e)=>!t||e.out<t.out?e:t),void 0),c=void 0!==h?h.maxY:r.landing;let u={d:1/0};for(let t=e;t<=c;t++){const e=r.flight.flightPoints[t],n=o.neighbors(e.x*a,e.y,1)[0]+r.launch;if(void 0!==n){const t=r.flight.flightPoints[n],i=r.scoring.rounding(e.distanceEarth(t));i<u.d&&(u.d=i,u.out=e,u.in=t)}}if(void 0!==h){const t=h.o.out,e=h.o.in,n=r.scoring.rounding(t.distanceEarth(e));n<u.d&&(console.log("This flight is very interesting because it has multiple possible closings, please consider submitting it for the unit testing of this program by opening an issue on https://github.com/mmomtchev/igc-xc-score"),u.d=n,u.out=t,u.in=e)}return r.flight.closestPairs.insert({minX:u.in.r,minY:e,maxX:t,maxY:u.out.r,o:u}),u}(t,e,n);return o.d<=n.scoring.closingDistance(r,n)&&o}const P=10,D={t:60,x0:1.5,xt:5,z0:.05,zt:.9},k={t:20,xmax:2.5,zmax:.1};function L(t,e){return e.scoring.rounding(t>(e.scoring.closingDistanceFree||0)?t:0)}function S(t,e){return e.scoring.rounding(Math.max(e.scoring.closingDistanceFixed||0,t*(e.scoring.closingDistanceRelative||0)))}function F(t,e){return e.scoring.finalRounding?e.scoring.finalRounding(t):e.scoring.rounding?e.scoring.rounding(t):t}function T(t,e,r){const n=M(r.launch,t[0].start,e[0],r),i=M(t[2].end,r.landing,e[2],r),o=r.scoring.rounding(E([n,e[0],e[1],e[2],i]));return o<(r.scoring.minDistance||0)?0:F(o*r.scoring.multiplier,r)}function I(t,e){let r=0;const n=M(e.launch,t[0].r,t[0],e),i=M(t[2].r,e.landing,t[2],e),o=[n,t[0],t[1],t[2],i],s=[{name:"START : TP1"},{name:"TP1 : TP2"},{name:"TP2 : TP3"},{name:"TP3 : FINISH"}];for(let t=0;t<o.length-1;t++)s[t].d=e.scoring.rounding(o[t].distanceEarth(o[t+1])),r+=s[t].d,s[t].start=o[t],s[t].finish=o[t+1];return r=F(r,e),{distance:r,score:r>=(e.scoring.minDistance||0)?F(r*e.scoring.multiplier,e):0,tp:t,ep:{start:n,finish:i},legs:s}}function R(t,e,r){const n=function(t,e){const r=Math.min(t[0].x1,t[1].x1,t[2].x1),n=Math.min(t[0].y1,t[1].y1,t[2].y1),i=Math.max(t[0].x2,t[1].x2,t[2].x2),o=Math.max(t[0].y2,t[1].y2,t[2].y2);let s=!1;for(let e=0;e<3;e++)if(t[e].intersects(t[(e+1)%3])){s=!0;break}const a=[[],[],[]];for(let e=0;e<3;e++){const h=t[e].vertices();for(let t of h)t.x!=r&&t.x!=i||t.y!=n&&t.y!=o||a[e].push(t);if(0==a[e].length)for(let t of h)t.x!=r&&t.x!=i&&t.y!=n&&t.y!=o||a[e].push(t);(0==a[e].length||s)&&(a[e]=h)}let h=0;for(let t of a[0])for(let r of a[1])for(let n of a[2]){const i=e(t,r,n);h=Math.max(h,i)}return h}(e,((t,e,n)=>r.scoring.rounding(t.distanceEarth(e))+r.scoring.rounding(e.distanceEarth(n))+r.scoring.rounding(n.distanceEarth(t))));if(n<(r.scoring.minDistance||0))return 0;let i=n;if(void 0!==r.scoring.minSide&&(i=function(t,e,r){const n=function(t,e){const r=t[0].vertices(),n=t[1].vertices(),i=t[2].vertices();let o=1/0;for(let t of r)for(let r of n)for(let n of i){const i=e(t,r,n);o=Math.min(o,i)}return o}(e,((t,e,n)=>r.scoring.rounding(t.distanceEarth(e))+r.scoring.rounding(e.distanceEarth(n))+r.scoring.rounding(n.distanceEarth(t))));if(t<n)return 0;const i=r.scoring.rounding(C([e[0],e[1]])),o=r.scoring.rounding(C([e[1],e[2]])),s=r.scoring.rounding(C([e[2],e[0]])),a=r.scoring.rounding(Math.min(i,o,s)/r.scoring.minSide);return a<n?0:Math.min(a,t)}(i,e,r)),void 0!==r.scoring.maxSide&&(i=function(t,e,r){const n=r.scoring.rounding(O([e[0],e[1]])),i=r.scoring.rounding(O([e[1],e[2]])),o=r.scoring.rounding(O([e[2],e[0]]));return r.scoring.rounding(Math.max(n,i,o)/r.scoring.maxSide)>t?0:t}(i,e,r)),0===i)return 0;let o={d:0};return t[0].end<t[2].start?(o=A(t[0].end,t[2].start,i,r),o?F((i-L(o.d,r))*r.scoring.multiplier,r):0):F(i*r.scoring.multiplier,r)}function N(t,e){let r=0;const n=[{name:"TP1 : TP2"},{name:"TP2 : TP3"},{name:"TP3 : TP1"}];for(let i=0;i<t.length;i++)n[i].d=e.scoring.rounding(t[i].distanceEarth(t[(i+1)%t.length])),r+=n[i].d,n[i].start=t[i],n[i].finish=t[(i+1)%t.length];if(r=F(r,e),r<(e.scoring.minDistance||0))return{score:0};if(void 0!==e.scoring.minSide){const t=e.scoring.minSide*r;if(n[0].d<t||n[1].d<t||n[2].d<t)return{score:0}}if(void 0!==e.scoring.maxSide){const t=e.scoring.maxSide*r;if(n[0].d>t||n[1].d>t||n[2].d>t)return{score:0}}let i=A(t[0].r,t[2].r,r,e);if(!i)return{score:0};const o=L(i.d,e);return{distance:r,score:F((r-o)*e.scoring.multiplier,e),tp:t,cp:i,legs:n,penalty:o}}function B(t,e,r){const n=2*r.scoring.rounding(C(e));if(n<(r.scoring.minDistance||0))return 0;if(t[0].end<t[1].start){const e=A(t[0].end,t[1].start,n,r);return e?F((n-L(e.d,r))*r.scoring.multiplier,r):0}return F(n*r.scoring.multiplier,r)}function X(t,e){const r=e.scoring.rounding(t[0].distanceEarth(t[1])),n=F(2*r,e);if(n<(e.scoring.minDistance||0))return{score:0};let i=A(t[0].r,t[1].r,n,e);if(!i)return{score:0};const o=L(i.d,e);return{distance:n,score:F((n-o)*e.scoring.multiplier,e),tp:t,cp:i,legs:[{name:"TP1 : TP2",start:t[0],finish:t[1],d:r},{name:"TP2 : TP1",start:t[1],finish:t[0],d:r}],penalty:o}}function q(t,e){if(!t.tp||!t.legs||0==t.score)return;function r(t,r){const n=t.distanceEarth(r),i=(n+e.scoring.cylinders)/n,o=(1-i)*r.x+i*t.x,s=(1-i)*r.y+i*t.y;return new h(o,s)}const n=[];for(const e in t.tp){if(void 0===t.tp[e].r)continue;let i=+e-1;i=i<0?t.ep?t.ep.start:t.tp[t.tp.length-1]:t.tp[i];let o=+e+1;o=o>=t.tp.length?t.ep?t.ep.finish:t.tp[0]:t.tp[o];const s=new h((i.x+o.x)/2,(i.y+o.y)/2);n[e]=r(t.tp[e],s)}for(const e in t.tp)n[e]&&(t.tp[e]=n[e]);switch(t.ep&&t.ep.start&&(t.ep.start=r(t.ep.start,t.tp[0])),t.ep&&t.ep.finish&&(t.ep.finish=r(t.ep.finish,t.tp[2])),e.scoring.code){case"tri":case"fai":t.distance=0;for(let r=0;r<t.legs.length;r++)t.legs[r].d=e.scoring.rounding(t.tp[r].distanceEarth(t.tp[(r+1)%t.tp.length]))-2*e.scoring.cylinders,t.distance+=t.legs[r].d;break;case"oar":{const r=e.scoring.rounding(t.tp[0].distanceEarth(t.tp[1]))-e.scoring.cylinders;t.legs[0].d=t.legs[1].d=r,t.distance=2*r}break;case"od":{const r=[t.ep.start,t.tp[0],t.tp[1],t.tp[2],t.ep.finish];t.distance=0;for(let n=0;n<r.length-1;n++)t.legs[n].d=e.scoring.rounding(r[n].distanceEarth(r[n+1])),t.legs[n].d-=2*e.scoring.cylinders,t.distance+=t.legs[n].d}}t.distance=F(t.distance,e),t.score=t.distance>=(e.scoring.minDistance||0)?F((t.distance-(t.penalty||0))*e.scoring.multiplier,e):0}const H={FFVL:[{name:"Distance 3 points",multiplier:1,bound:T,score:I,rounding:Y,cardinality:3,code:"od"},{name:"Triangle plat",multiplier:1.2,bound:R,score:N,closingDistance:S,closingDistanceFixed:3,closingDistanceFree:3,closingDistanceRelative:.05,rounding:Y,cardinality:3,code:"tri"},{name:"Triangle FAI",multiplier:1.4,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFixed:3,closingDistanceFree:3,closingDistanceRelative:.05,rounding:Y,cardinality:3,code:"fai"}],XContest:[{name:"Free Flight",multiplier:1,bound:T,score:I,rounding:Y,cardinality:3,code:"od"},{name:"Free Triangle",multiplier:1.2,bound:R,score:N,closingDistance:S,closingDistanceRelative:.2,rounding:Y,cardinality:3,code:"tri"},{name:"FAI Triangle",multiplier:1.4,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceRelative:.2,rounding:Y,cardinality:3,code:"fai"},{name:"Closed Free Triangle",multiplier:1.4,bound:R,score:N,closingDistance:S,closingDistanceFixed:0,closingDistanceFree:0,closingDistanceRelative:.05,rounding:Y,cardinality:3,code:"tri"},{name:"Closed FAI Triangle",multiplier:1.6,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFixed:0,closingDistanceFree:0,closingDistanceRelative:.05,rounding:Y,cardinality:3,code:"fai"}],FAI:[{name:"Free Distance around 3 TPs",multiplier:1,bound:T,score:I,rounding:Y,finalRounding:z,cardinality:3,code:"od"},{name:"Free Triangle",multiplier:1.2,bound:R,score:N,closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri"},{name:"FAI Triangle",multiplier:1.4,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"fai"}],"FAI-Cylinders":[{name:"Free Distance around 3 TPs",multiplier:1,bound:T,score:I,rounding:Y,finalRounding:z,cardinality:3,code:"od",cylinders:.4,post:q},{name:"Free Triangle",multiplier:1.2,bound:R,score:N,closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",cylinders:.4,post:q},{name:"FAI Triangle",multiplier:1.4,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"fai",cylinders:.4,post:q}],"FAI-OAR":[{name:"Out-and-Return Distance",multiplier:1,bound:function(t,e,r){const n=new u(Math.min(e[0].x1,e[2].x1),Math.min(e[0].y1,e[2].y1),Math.max(e[0].x2,e[2].x2),Math.max(e[0].y2,e[2].y2)),i=r.scoring.rounding(C([e[1],n]));if(i<(r.scoring.minDistance||0))return 0;if(t[0].end<t[2].start){const n=function(t,e,r,n){const i=function(t,e,r){const n=new g(t.end+1-t.start),i=Math.abs(Math.cos(s(r.flight.flightPoints[t.start].y)));for(let e=t.start;e<=t.end;e++){const t=r.flight.flightPoints[e];n.add(t.x*i,t.y,t.x*i,t.y)}n.finish();let o={d:1/0};for(let s=e.start;s<=e.end;s++){const e=r.flight.flightPoints[s],a=n.neighbors(e.x*i,e.y,1)[0]+t.start;if(void 0!==a){const t=r.flight.flightPoints[a],n=r.scoring.rounding(e.distanceEarth(t));n<o.d&&(o.d=n,o.out=e,o.in=t)}}return o}(t,e,n);return i.d<=n.scoring.closingDistance(r,n)&&i}(t[0],t[2],i,r);if(!n)return 0;const o=new u((e[0].x1+e[2].x1)/2,(e[0].y1+e[2].y1)/2,(e[0].x2+e[2].x2)/2,(e[0].y2+e[2].y2)/2);return F(2*(r.scoring.rounding(C([e[1],o]))-L(n.d,r))*r.scoring.multiplier,r)}return F(2*i*r.scoring.multiplier,r)},score:function(t,e){const r=new h((t[0].x+t[2].x)/2,(t[0].y+t[2].y)/2),n=e.scoring.rounding(t[1].distanceEarth(r)),i=F(2*n,e);if(i<(e.scoring.minDistance||0))return{score:0};const o=e.scoring.rounding(t[0].distanceEarth(t[2]));if(o>e.scoring.closingDistance(i,e))return{score:0};const s=F((i-L(o,e))*e.scoring.multiplier,e),a=[{name:"TP1 : TP2",start:t[1],finish:r,d:n},{name:"TP2 : TP1",start:r,finish:t[1],d:n}];return{distance:i,score:s,tp:[t[1],r],cp:{d:o,in:t[0],out:t[2]},legs:a}},closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"oar"}],"FAI-OAR2":[{name:"Out-and-Return Flight around 2 TPs",multiplier:1,bound:B,score:X,closingDistance:S,closingDistanceFree:.8,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:2,code:"oar"}],XCLeague:[{name:"Out-and-Return Distance >=35km",multiplier:2,bound:B,score:X,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:2,code:"oar",minDistance:35},{name:"Out-and-Return Distance >=15km",multiplier:1.5,bound:B,score:X,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:2,code:"oar",minDistance:15},{name:"Out-and-Return Distance >=5km (Clubs)",multiplier:1.2,bound:B,score:X,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:2,code:"oar",minDistance:5},{name:"Turnpoint Flight",multiplier:1,bound:T,score:I,rounding:Y,finalRounding:z,cardinality:3,code:"od",minDistance:5},{name:"Flat Triangle >=35km",multiplier:2,bound:R,score:N,minSide:.15,maxSide:.45,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:35},{name:"Flat Triangle >=15km",multiplier:1.5,bound:R,score:N,minSide:.15,maxSide:.45,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:15},{name:"Flat Triangle >=5km (Clubs)",multiplier:1.2,bound:R,score:N,minSide:.15,maxSide:.45,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:5},{name:"FAI Triangle >=25km",multiplier:2.3,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:25},{name:"FAI Triangle >=15km",multiplier:2,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:15},{name:"FAI Triangle >=5km (Clubs)",multiplier:1.5,bound:R,score:N,minSide:.28,closingDistance:S,closingDistanceFixed:.8,rounding:Y,finalRounding:z,cardinality:3,code:"tri",minDistance:5}]};function Y(t){return parseFloat(parseFloat(t).toFixed(2))}function z(t){return parseFloat(parseFloat(t).toFixed(1))}const G=H;function*V(t,e,r){let n;const o=e||G.FFVL,s=r||{};(function(t,e){if(e.invalid?t.filtered=t.fixes.slice(0):t.filtered=t.fixes.filter((t=>t.valid)).filter(((t,e,r)=>0==e||r[e-1].timestamp!==t.timestamp)),t.filtered.length<5)throw new Error(`Flight must contain at least 5 valid GPS fixes, ${t.filtered.length} valid fixes found (out of ${t.fixes.length})`);e.trim||e.detectLaunch||e.detectLanding?(function(t){for(let e=0;e<t.length;e++)if((null==t[e].pressureAltitude||t[e].pressureAltitude<-1e3)&&(t[e].pressureAltitude=t[e].gpsAltitude),null===t[e].pressureAltitude&&(t[e].gpsAltitude=void 0),e>0){const r=t[e].timestamp-t[e-1].timestamp;r>0?(t[e].hspeed=1e3*new h(t,e-1).distanceEarth(new h(t,e))/r*1e3,t[e].vspeed=(t[e].pressureAltitude-t[e-1].pressureAltitude)/r*1e3):(t[e].hspeed=t[e-1].hspeed,t[e].vspeed=t[e-1].vspeed)}else t[e].hspeed=0,t[e].vspeed=0;for(let e=0;e<t.length;e++){const r=t[e].timestamp;let n,i;for(n=e;n>0&&t[n].timestamp>r-Math.round(1e3*P/2);n--);for(i=e;i<t.length-1&&t[i].timestamp<r+Math.round(1e3*P/2);i++);const o=t.slice(n,i+1);t[e].hma=o.reduce(((t,e)=>t+e.hspeed),0)/o.length,t[e].vma=o.reduce(((t,e)=>t+Math.abs(e.vspeed)),0)/o.length}}(t.filtered),function(t){let e;for(let r=0;r<t.length-1;r++)if(void 0===e&&t[r].hma>D.xt&&t[r].vma>D.zt&&(e=r),void 0!==e)if(t[r].hma>D.x0&&t[r].vma>D.z0){if(t[r].timestamp>t[e].timestamp+1e3*D.t)for(let n=e;n<=r;n++)t[r].stateFlight=!0}else e=void 0}(t.filtered),function(t){let e;for(let r=0;r<t.length-1;r++)if(void 0===e&&t[r].hma<k.xmax&&t[r].vma<k.zmax&&(e=r),void 0!==e)if(t[r].hma<k.xmax&&t[r].vma<k.zmax){if(t[r].timestamp>t[e].timestamp+1e3*k.t)for(let n=e;n<=r;n++)t[r].stateGround=!0}else e=void 0}(t.filtered),t.ll=function(t){let e=[];for(let r=0;r<t.length-1;r++)if(t[r].stateFlight){let n;for(n=r;n>0&&!t[n].stateGround;n--);const i=n;for(n=r;n<t.length-2&&!t[n].stateGround;n++);const o=n;r=n,e.push({launch:i,landing:o})}return 0==e.length&&e.push({launch:0,landing:t.length-1}),e}(t.filtered)):t.ll=[{launch:0,landing:t.filtered.length-1}]})(t,s),function(t){t.flight.closestPairs=new _,t.flight.furthestPoints=[new w,new w],t.flight.flightPoints=new Array(t.flight.filtered.length);for(let e in t.flight.filtered)t.flight.flightPoints[e]=new h(t.flight.filtered,e)}({flight:t}),s.hp?h.prototype.distanceEarth=h.prototype.distanceEarthVincentys:h.prototype.distanceEarth=h.prototype.distanceEarthFCC;let a=[];for(let e of o)for(let r of t.ll){const n={flight:t,launch:r.launch,landing:r.landing,scoring:e,config:s};let i=new p([new c(r.launch,r.landing),new c(r.launch,r.landing),new c(r.launch,r.landing)],n);i.do_bound(),i.do_score(),a.push(i)}let u=a[0],l=new i(a,p.prototype.contentEquals,p.prototype.contentCompare),f=0,d=0;do{const t=Date.now();for(;l.length>0;){if(f%100==0&&s.env&&"undefined"!==s.env.v8){const t=s.env.v8.getHeapStatistics();if(t.used_heap_size/t.heap_size_limit>.98){console.error(`Out of memory: ${t.used_heap_size/1024}KiB used of ${t.heap_size_limit/1024}KiB total`);break}}let e=l.pop();if(e.bound<=u.score){l.clear();break}let r=e.do_branch();for(let t of r)if(t.do_bound(),!(t.bound<=u.score)){if(t.do_score(),f++,t.score>=u.score&&t.score>0){if(u=t,l.findLeast()&&l.findLeast().value.bound<=u.score){const t=l.findGreatestLessThanOrEqual({bound:u.score});if(void 0!==t){const e=l.indexOf(t.value);l.splice(0,e+1).length}}}else delete t.scoreInfo;l.push(t),s.debug&&(u.last=t)}if(f>s.maxloop||Date.now()-t>s.maxcycle)break}u.processed=f;const e=l.findGreatest();if(u.currentUpperBound=e?e.value.bound:u.bound,d+=Date.now()-t,u.time=d,0==l.length?u.optimal=!0:u.optimal=!1,u.optimal)return n=!0,u;n=yield u}while(!n)}let $,U=null;function W(t){const e=this.next();!e.done&&Date.now()<U?$=window.requestIdleCallback(W.bind(this,t)):($=void 0,t(e))}const J=H;function K(t,r,n,i){if("function"!=typeof r)return;G&&!G.hasOwnProperty(n)&&(n="FFVL"),$&&(window.cancelIdleCallback($),$=void 0);const o=e().parse(t,{lenient:!0});window.requestIdleCallback((()=>{let t=V(o,G[n],{maxcycle:1e3});"number"!=typeof i&&(i=10),U=Date.now()+1e3*i,W.call(t,r)}))}})(),IGCScore=n})();